<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SSC CGL PRO</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Montserrat:wght@400;500;600;700;800&family=Roboto:wght@300;400;500;700&family=Inter:wght@300;400;500;600;700;800&family=Nunito:wght@400;500;600;700;800&family=Raleway:wght@400;500;600;700;800&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ===== CSS Variables for Themes (refined for better contrast & lighter drawer) ===== */
    :root {
      /* Modern Light Theme (Default) - tuned for readable text & lighter drawer */
      --bg: #f8fafc;
      --glass: rgba(15, 23, 42, 0.03);               /* lighter glass for subtle depth */
      --card: #ffffff;
      --text: #0b1220;                                 /* slightly stronger than before */
      --muted: #525f73;                                /* darker muted for legibility */
      --border: #e6eef6;                               /* soft border */
      --accent: #2563eb;                               /* clearer blue accent */
      --accent-2: #7c3aed;
      --accent-3: #059669;
      --accent-4: #f59e0b;
      --accent-5: #ef4444;
      --accent-6: #db2777;
      --pill: #f1f5f9;
      --shadow: 0 12px 35px rgba(2,6,23,0.08);
      --gradient: linear-gradient(135deg, #2563eb, #7c3aed, #f59e0b, #059669);
      --gradient-card: linear-gradient(145deg, #ffffff, #f8fafc);
      --success: #059669;
      --warning: #f59e0b;
      --danger: #ef4444;
      --drawer-bg: rgba(255, 255, 255, 0.92);         /* lighter drawer so outer text stands out */
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%232563eb" opacity="0.28"/><circle cx="80" cy="30" r="8" fill="%237c3aed" opacity="0.22"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%23f59e0b" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%23059669" stroke-width="1" opacity="0.08"/></svg>');
      --card-opacity: 0.98;
      --font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --header-text-color: #071029;                    /* darker header for crisp titles */
      --menu-text-color: var(--accent);                /* menu uses accent for clarity */
      --theme-btn-light: #2563eb;
      --theme-btn-dark: #1e293b;
      --theme-btn-blue: #1e40af;
      --theme-btn-green: #065f46;
      --theme-btn-purple: #5b21b6;
      --theme-btn-pink: #be185d;
      --theme-btn-orange: #ea580c;
    }

    /* Dark Theme - improved readability, slightly lighter drawer for white text contrast */
    .theme-dark {
      --bg: #071125;                                   /* deep but not fully black to reduce strain */
      --glass: rgba(255,255,255,0.06);                 /* subtle glass on dark */
      --card: #111827;
      --text: #f8fafc;                                 /* very readable text on dark */
      --muted: #98a7bb;                                /* readable muted */
      --border: #243340;
      --accent: #60a5fa;
      --accent-2: #a78bfa;
      --accent-3: #34d399;
      --accent-4: #fbbf24;
      --accent-5: #f87171;
      --accent-6: #f472b6;
      --pill: #0f1726;
      --shadow: 0 12px 35px rgba(0,0,0,0.5);
      --gradient: linear-gradient(135deg, #60a5fa, #a78bfa, #fbbf24, #34d399);
      --gradient-card: linear-gradient(145deg, #0f1726, #0b1220);
      --success: #34d399;
      --warning: #fbbf24;
      --danger: #f87171;
      --drawer-bg: rgba(15, 23, 42, 0.85);             /* lighter than before so content edges readable */
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%2360a5fa" opacity="0.28"/><circle cx="80" cy="30" r="8" fill="%23a78bfa" opacity="0.22"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%23fbbf24" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%2334d399" stroke-width="1" opacity="0.08"/></svg>');
      --card-opacity: 0.94;
      --font-family: 'Roboto', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --header-text-color: #f8fafc;
      --menu-text-color: var(--accent);
      --theme-btn-light: #60a5fa;
      --theme-btn-dark: #334155;
      --theme-btn-blue: #93c5fd;
      --theme-btn-green: #34d399;
      --theme-btn-purple: #a78bfa;
      --theme-btn-pink: #f472b6;
      --theme-btn-orange: #fdba74;
    }

    /* Blue Theme - keep cards bright & drawer slightly translucent */
    .theme-blue {
      --bg: linear-gradient(135deg, #0f172a 0%, #0b3b7a 100%);
      --glass: rgba(255,255,255,0.10);
      --card: rgba(255, 255, 255, 0.98);
      --text: #071029;
      --muted: #475569;
      --border: #cfe8ff;
      --accent: #1e40af;
      --accent-2: #3730a3;
      --accent-3: #0d9488;
      --accent-4: #ea580c;
      --accent-5: #dc2626;
      --accent-6: #db2777;
      --pill: rgba(30, 58, 138, 0.14);
      --shadow: 0 12px 35px rgba(14, 165, 233, 0.18);
      --gradient: linear-gradient(135deg, #2563eb, #4f46e5, #ea580c, #0d9488);
      --gradient-card: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
      --success: #059669;
      --warning: #d97706;
      --danger: #dc2626;
      --drawer-bg: rgba(30, 58, 138, 0.88);            /* lighter so outer text contrasts */
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%231e40af" opacity="0.32"/><circle cx="80" cy="30" r="8" fill="%234f46e5" opacity="0.24"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%23ea580c" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%230d9488" stroke-width="1" opacity="0.1"/></svg>');
      --card-opacity: 0.96;
      --font-family: 'Montserrat', 'Arial', sans-serif;
      --header-text-color: #08123a;
      --menu-text-color: var(--accent);
      --theme-btn-light: #60a5fa;
      --theme-btn-dark: #1e40af;
      --theme-btn-blue: #2563eb;
      --theme-btn-green: #0d9488;
      --theme-btn-purple: #4f46e5;
      --theme-btn-pink: #db2777;
      --theme-btn-orange: #ea580c;
    }

    /* Green Theme - tuned contrasts and lighter drawer */
    .theme-green {
      --bg: linear-gradient(135deg, #064e3b 0%, #047857 100%);
      --glass: rgba(255,255,255,0.10);
      --card: rgba(255, 255, 255, 0.98);
      --text: #071029;
      --muted: #475569;
      --border: #dff7ef;
      --accent: #059669;
      --accent-2: #7c3aed;
      --accent-3: #0d9488;
      --accent-4: #f59e0b;
      --accent-5: #ef4444;
      --accent-6: #db2777;
      --pill: rgba(6, 78, 59, 0.12);
      --shadow: 0 12px 35px rgba(5, 90, 67, 0.14);
      --gradient: linear-gradient(135deg, #059669, #7c3aed, #f59e0b, #0d9488);
      --gradient-card: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
      --success: #059669;
      --warning: #d97706;
      --danger: #dc2626;
      --drawer-bg: rgba(6, 95, 70, 0.88);
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%23059669" opacity="0.32"/><circle cx="80" cy="30" r="8" fill="%237c3aed" opacity="0.24"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%23f59e0b" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%230d9488" stroke-width="1" opacity="0.1"/></svg>');
      --card-opacity: 0.96;
      --font-family: 'Nunito', 'Verdana', sans-serif;
      --header-text-color: #044936;
      --menu-text-color: var(--accent);
      --theme-btn-light: #10b981;
      --theme-btn-dark: #047857;
      --theme-btn-blue: #0d9488;
      --theme-btn-green: #059669;
      --theme-btn-purple: #7c3aed;
      --theme-btn-pink: #db2777;
      --theme-btn-orange: #f59e0b;
    }

    /* Purple Theme - improved contrast + lighter drawer */
    .theme-purple {
      --bg: linear-gradient(135deg, #4c1d95 0%, #6d28d9 100%);
      --glass: rgba(255,255,255,0.10);
      --card: rgba(255, 255, 255, 0.98);
      --text: #071029;
      --muted: #4b5563;
      --border: #e9e5ff;
      --accent: #7c3aed;
      --accent-2: #3b82f6;
      --accent-3: #10b981;
      --accent-4: #f59e0b;
      --accent-5: #ec4899;
      --accent-6: #ec4899;
      --pill: rgba(91, 33, 182, 0.12);
      --shadow: 0 12px 35px rgba(99, 60, 205, 0.16);
      --gradient: linear-gradient(135deg, #7c3aed, #3b82f6, #f59e0b, #10b981);
      --gradient-card: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ec4899;
      --drawer-bg: rgba(91, 33, 182, 0.88);
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%237c3aed" opacity="0.32"/><circle cx="80" cy="30" r="8" fill="%233b82f6" opacity="0.24"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%23f59e0b" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%2310b981" stroke-width="1" opacity="0.1"/></svg>');
      --card-opacity: 0.96;
      --font-family: 'Poppins', 'Georgia', serif;
      --header-text-color: #3b1464;
      --menu-text-color: var(--accent);
      --theme-btn-light: #8b5cf6;
      --theme-btn-dark: #7c3aed;
      --theme-btn-blue: #6366f1;
      --theme-btn-green: #10b981;
      --theme-btn-purple: #7c3aed;
      --theme-btn-pink: #ec4899;
      --theme-btn-orange: #f59e0b;
    }

    /* Pink Theme - refined */
    .theme-pink {
      --bg: linear-gradient(135deg, #9f1239 0%, #be185d 100%);
      --glass: rgba(255,255,255,0.10);
      --card: rgba(255, 255, 255, 0.98);
      --text: #071029;
      --muted: #4b5563;
      --border: #ffe6ef;
      --accent: #db2777;
      --accent-2: #9333ea;
      --accent-3: #059669;
      --accent-4: #f59e0b;
      --accent-5: #ef4444;
      --accent-6: #db2777;
      --pill: rgba(190, 24, 93, 0.12);
      --shadow: 0 12px 35px rgba(221, 39, 119, 0.14);
      --gradient: linear-gradient(135deg, #db2777, #9333ea, #f59e0b, #059669);
      --gradient-card: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
      --success: #059669;
      --warning: #f59e0b;
      --danger: #ef4444;
      --drawer-bg: rgba(190, 24, 93, 0.88);
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%23db2777" opacity="0.32"/><circle cx="80" cy="30" r="8" fill="%239333ea" opacity="0.24"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%23f59e0b" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%23059669" stroke-width="1" opacity="0.1"/></svg>');
      --card-opacity: 0.96;
      --font-family: 'Raleway', 'Arial', sans-serif;
      --header-text-color: #8a153c;
      --menu-text-color: var(--accent);
      --theme-btn-light: #f472b6;
      --theme-btn-dark: #db2777;
      --theme-btn-blue: #9333ea;
      --theme-btn-green: #059669;
      --theme-btn-purple: #9333ea;
      --theme-btn-pink: #db2777;
      --theme-btn-orange: #f59e0b;
    }

    /* Orange Theme - tuned */
    .theme-orange {
      --bg: linear-gradient(135deg, #b45309 0%, #ea580c 100%);
      --glass: rgba(255,255,255,0.10);
      --card: rgba(255, 255, 255, 0.98);
      --text: #071029;
      --muted: #475569;
      --border: #fff1e6;
      --accent: #f97316;
      --accent-2: #9333ea;
      --accent-3: #059669;
      --accent-4: #3b82f6;
      --accent-5: #ef4444;
      --accent-6: #db2777;
      --pill: rgba(234, 88, 12, 0.12);
      --shadow: 0 12px 35px rgba(249, 115, 22, 0.16);
      --gradient: linear-gradient(135deg, #f97316, #9333ea, #3b82f6, #059669);
      --gradient-card: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
      --success: #059669;
      --warning: #f97316;
      --danger: #ef4444;
      --drawer-bg: rgba(234, 88, 12, 0.88);
      --illustration: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 100 100"><rect x="18" y="18" width="12" height="12" fill="%23f97316" opacity="0.32"/><circle cx="80" cy="30" r="8" fill="%239333ea" opacity="0.24"/><polygon points="40,80 50,70 60,80 55,90 45,90" fill="%233b82f6" opacity="0.28"/><path d="M10,50 Q50,10 90,50 T10,50" fill="none" stroke="%23059669" stroke-width="1" opacity="0.1"/></svg>');
      --card-opacity: 0.96;
      --font-family: 'Quicksand', 'Verdana', sans-serif;
      --header-text-color: #87350b;
      --menu-text-color: var(--accent);
      --theme-btn-light: #fdba74;
      --theme-btn-dark: #f97316;
      --theme-btn-blue: #3b82f6;
      --theme-btn-green: #059669;
      --theme-btn-purple: #9333ea;
      --theme-btn-pink: #db2777;
      --theme-btn-orange: #f97316;
    }

/* ===== Helpful small utilities (optional) =====
   You can add these to ensure components use the variables consistently.
*/
.app-root { background: var(--bg); color: var(--text); font-family: var(--font-family); }
.card { background: var(--card); color: var(--text); box-shadow: var(--shadow); border: 1px solid var(--border); opacity: var(--card-opacity); }
.drawer { background: var(--drawer-bg); color: var(--text); backdrop-filter: blur(6px); }

    /* ===== Base Styles ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    
    html, body {
      height: 100%;
      font-family: var(--font-family);
      transition: background-color 0.5s ease, color 0.3s ease;
    }
    
    body {
      background: var(--bg);
      background-image: var(--illustration);
      background-size: 300px;
      color: var(--text);
      overflow-x: hidden;
      position: relative;
      padding-bottom: 70px;
    }
    
    /* Animated background elements */
    .bg-doodle {
      position: fixed;
      pointer-events: none;
      z-index: -1;
      opacity: 0.1;
    }
    
    .bg-doodle-1 {
      top: 10%;
      left: 5%;
      width: 100px;
      height: 100px;
      border-radius: 20px;
      background: var(--accent);
      animation: float 20s infinite linear;
      transform: rotate(45deg);
    }
    
    .bg-doodle-2 {
      top: 60%;
      right: 10%;
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: var(--accent-2);
      animation: float 25s infinite linear reverse;
    }
    
    .bg-doodle-3 {
      bottom: 20%;
      left: 15%;
      width: 80px;
      height: 80px;
      border-radius: 20px;
      background: var(--accent-3);
      animation: float 18s infinite linear;
      transform: rotate(45deg);
    }
    
    .bg-doodle-4 {
      top: 20%;
      right: 20%;
      width: 120px;
      height: 120px;
      border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
      background: var(--accent-4);
      animation: float 30s infinite linear;
    }
    
    .bg-doodle-5 {
      top: 80%;
      left: 20%;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      background: var(--accent-5);
      animation: float 22s infinite linear reverse;
    }
    
    .bg-doodle-6 {
      bottom: 40%;
      right: 5%;
      width: 110px;
      height: 110px;
      border-radius: 20px;
      background: var(--accent-6);
      animation: float 28s infinite linear;
      transform: rotate(45deg);
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }
    
    /* ===== Welcome Screen ===== */
    #welcomeScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      background-image: var(--illustration);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.8s ease, visibility 0.8s ease;
    }
    
    #welcomeScreen.hidden {
      opacity: 0;
      visibility: hidden;
    }
    
    .welcome-content {
      text-align: center;
      max-width: 600px;
      padding: 40px 30px;
      background: var(--card);
      backdrop-filter: blur(20px);
      border-radius: 28px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
      margin: 20px;
      opacity: var(--card-opacity);
    }
    
    .welcome-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient);
    }
    
    .welcome-logo {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: var(--gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
      animation: pulse 2.5s infinite;
      border: 5px solid rgba(255, 255, 255, 0.2);
      overflow: hidden;
    }
    
    .welcome-logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
      padding: 8px;
      background: white;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
      50% { transform: scale(1.05); box-shadow: 0 25px 50px rgba(0,0,0,0.2); }
      100% { transform: scale(1); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
    }
    
    .welcome-content h1 {
      font-size: 2.8rem;
      margin: 0 0 15px;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 900;
      letter-spacing: -0.5px;
      font-family: var(--font-family);
    }
    
    .welcome-content p {
      color: var(--muted);
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: 25px;
      padding: 0 10px;
      font-family: var(--font-family);
    }
    
    .name-input {
      width: 100%;
      padding: 15px 20px;
      margin: 15px 0;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--border);
      border-radius: 16px;
      color: var(--text);
      font-size: 1.1rem;
      text-align: center;
      transition: all 0.3s ease;
      font-family: var(--font-family);
    }
    
    .name-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3);
      background: rgba(255, 255, 255, 0.15);
    }
    
    /* Button styles */
    .welcome-btn {
      background: var(--gradient);
      color: white;
      border: none;
      padding: 16px 40px;
      font-size: 1.2rem;
      font-weight: 700;
      border-radius: 16px;
      cursor: pointer;
      box-shadow: 0 15px 35px rgba(59, 130, 246, 0.3);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      margin: 20px auto;
      display: block;
      width: 80%;
      max-width: 300px;
      text-align: center;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .welcome-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 25px 50px rgba(59, 130, 246, 0.4);
    }
    
    /* Button shine effect */
    .btn-shine {
      position: relative;
      overflow: hidden;
      background: var(--accent);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: var(--shadow);
      font-family: var(--font-family);
    }
    
    .btn-shine::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 40%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .btn-shine:hover::after {
      left: 120%;
    }
    
    .btn-shine:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      background: var(--accent-2);
    }
    
    /* ===== Header / Navigation ===== */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(12px);
      background: linear-gradient(180deg, var(--card), rgba(255,255,255,0.7));
      border-bottom: 1px solid var(--border);
      padding: 0 20px;
    }
    
    .theme-dark header {
      background: linear-gradient(180deg, rgba(15,23,42,0.9), rgba(15,23,42,0.7));
    }
    
    .theme-blue header, .theme-green header, .theme-purple header, .theme-pink header, .theme-orange header {
      background: linear-gradient(180deg, var(--card), rgba(255,255,255,0.8));
    }
    
    .nav-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px 0;
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .logo {
      width: 70px;
      height: 70px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: conic-gradient(from 220deg, var(--accent), var(--accent-3), var(--accent-4), var(--accent-2));
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 16px;
      padding: 4px;
      background: white;
    }
    
    .titles h1 {
      margin: 0;
      font-size: 1.5rem;
      letter-spacing: 0.2px;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 900;
      font-family: var(--font-family);
    }
    
    .titles p {
      margin: 4px 0 0;
      color: var(--muted);
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: var(--font-family);
    }
    
    .greeting {
      font-weight: 700;
      color: var(--accent);
      font-family: var(--font-family);
    }
    
    .nav-controls {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .nav-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--border);
      color: var(--text);
      width: 45px;
      height: 45px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.2rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .nav-btn:hover {
      background: var(--accent);
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .nav-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .nav-btn:hover::after {
      left: 120%;
    }
    
    /* ===== Bottom Navigation Bar ===== */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--card);
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: center;
      z-index: 99;
      padding: 8px;
      box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
      height: 65px;
    }
    
    .nav-tabs {
      display: flex;
      gap: 8px;
      max-width: 1200px;
      width: 100%;
      justify-content: center;
    }
    
    .nav-tab-btn {
      flex: 1;
      max-width: 180px;
      padding: 12px 8px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.85rem;
      height: 45px;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .nav-tab-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
    }
    
    .nav-tab-btn:hover:not(.active) {
      background: rgba(255,255,255,0.1);
      transform: translateY(-2px);
    }
    
    .nav-tab-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .nav-tab-btn:hover::after {
      left: 120%;
    }
    
    /* ===== Drawer Menu - FIXED COLORS ===== */
    .drawer-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .drawer-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .drawer {
      position: fixed;
      top: 0;
      right: 0;
      width: 380px;
      max-width: 90vw;
      height: 100%;
      background: var(--drawer-bg);
      backdrop-filter: blur(20px);
      z-index: 1000;
      overflow-y: auto;
      transition: transform 0.4s cubic-bezier(0.22, 0.61, 0.36, 1);
      box-shadow: -10px 0 40px rgba(0,0,0,0.3);
      border-left: 1px solid var(--border);
      transform: translateX(100%);
    }
    
    .drawer.active {
      transform: translateX(0);
    }
    
    .drawer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient);
    }
    
    .drawer-header {
      padding: 25px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent);
    }
    
    .drawer-header h2 {
      font-size: 1.5rem;
      color: var(--menu-text-color);
      font-weight: 800;
      font-family: var(--font-family);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .drawer-close {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      font-family: var(--font-family);
    }
    
    .drawer-close:hover {
      background: var(--accent);
      color: white;
      transform: rotate(90deg);
    }
    
    .drawer-content {
      padding: 25px;
    }
    
    .drawer-section {
      margin-bottom: 30px;
      padding: 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      border: 1px solid var(--border);
      position: relative;
      overflow: hidden;
    }
    
    .drawer-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--accent);
    }
    
    .drawer-section h3 {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: var(--accent);
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: var(--font-family);
    }
    
    .theme-selector {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .theme-btn {
      padding: 12px;
      border-radius: 12px;
      border: 2px solid var(--border);
      background: var(--card);
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }
    
    .theme-btn.active {
      border-color: var(--accent);
      box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
      transform: translateY(-2px);
    }
    
    /* FIXED: Theme buttons - LIGHTER colors for better visibility */
    .theme-btn[data-theme="light"] {
      background: #60a5fa;
      color: white;
    }
    
    .theme-btn[data-theme="dark"] {
      background: #4b5563;
      color: white;
    }
    
    .theme-btn[data-theme="blue"] {
      background: #3b82f6;
      color: white;
    }
    
    .theme-btn[data-theme="green"] {
      background: #10b981;
      color: white;
    }
    
    .theme-btn[data-theme="purple"] {
      background: #8b5cf6;
      color: white;
    }
    
    .theme-btn[data-theme="pink"] {
      background: #ec4899;
      color: white;
    }
    
    .theme-btn[data-theme="orange"] {
      background: #f97316;
      color: white;
    }
    
    .theme-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .theme-btn:hover::after {
      left: 120%;
    }
    
    /* Language Toggle */
    .language-toggle {
      display: flex;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 20px;
      overflow: hidden;
    }
    
    .lang-btn {
      flex: 1;
      padding: 12px;
      text-align: center;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .lang-btn.active {
      background: var(--accent);
      color: white;
    }
    
    .lang-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .lang-btn:hover::after {
      left: 120%;
    }
    
    .social-links {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .social-link {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      border-radius: 12px;
      background: rgba(255,255,255,0.05);
      text-decoration: none;
      color: var(--text);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .social-link:hover {
      background: var(--accent);
      transform: translateX(5px);
    }
    
    .social-link i {
      font-size: 1.3rem;
      width: 30px;
    }
    
    .btn-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .drawer-btn {
      padding: 15px;
      border-radius: 12px;
      border: none;
      background: rgba(255,255,255,0.1);
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      text-align: left;
      display: flex;
      align-items: center;
      gap: 12px;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .drawer-btn:hover {
      background: var(--accent);
      transform: translateX(5px);
    }
    
    .drawer-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .drawer-btn:hover::after {
      left: 120%;
    }
    
    .drawer-btn.danger {
      background: rgba(239, 68, 68, 0.2);
      color: var(--danger);
    }
    
    .drawer-btn.danger:hover {
      background: var(--danger);
      color: white;
    }
    
    /* ===== Main Container ===== */
    .container {
      max-width: 1200px;
      margin: 25px auto;
      padding: 0 20px;
    }
    
    /* ===== Tabs Content ===== */
    .tab-content {
      display: none;
      opacity: var(--card-opacity);
      animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: var(--card-opacity); transform: translateY(0); }
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* ===== Grid Layout ===== */
    .grid {
      display: grid;
      gap: 25px;
      grid-template-columns: 1fr 1fr;
    }
    
    @media (max-width: 992px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* ===== Cards ===== */
    .card {
      background: var(--gradient-card);
      border: 1px solid var(--border);
      border-radius: 20px;
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
      margin: 15px 0;
      opacity: var(--card-opacity);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: var(--gradient);
    }
    
    .card h2 {
      margin: 0;
      padding: 18px 20px;
      font-size: 1.2rem;
      background: linear-gradient(180deg, rgba(255,255,255,0.08), transparent);
      border-bottom: 1px solid var(--border);
      font-weight: 800;
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: space-between;
      flex-wrap: wrap;
      font-family: var(--font-family);
    }
    
    .card h3 {
      padding: 15px 20px;
      font-size: 1.1rem;
      border-bottom: 1px solid var(--border);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: var(--font-family);
    }
    
    .card .body {
      padding: 20px;
    }
    
    /* ===== Subject Controls in Card Header ===== */
    .subject-controls {
      display: flex;
      gap: 8px;
      margin-left: auto;
    }
    
    .subject-controls button {
      padding: 6px 10px;
      font-size: 0.75rem;
      background: rgba(255,255,255,0.1);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .subject-controls button:hover {
      background: var(--accent);
      color: white;
    }
    
    .subject-controls button::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .subject-controls button:hover::after {
      left: 120%;
    }
    
    /* ===== Subjects List ===== */
    .subject {
      margin-bottom: 20px;
      border: 1px solid var(--border);
      border-radius: 18px;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), transparent);
      transition: transform 0.3s ease;
    }
    
    .subject:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    /* FIXED: Mobile layout for subject header */
    .subject-header {
      display: flex;
      align-items: center;
      padding: 16px 18px;
      background: var(--pill);
      cursor: pointer;
      transition: background 0.3s ease;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .subject-header:hover {
      background: color-mix(in srgb, var(--pill) 90%, white);
    }
    
    .subject-title {
      display: flex;
      gap: 12px;
      align-items: center;
      flex: 1;
      min-width: 200px;
    }
    
    .badge {
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 0.85rem;
      color: white;
      font-weight: 800;
      background: var(--accent);
      white-space: nowrap;
      font-family: var(--font-family);
    }
    
    .badge.quantitative { background: #3b82f6; }
    .badge.english { background: #8b5cf6; }
    .badge.reasoning { background: #10b981; }
    .badge.general-awareness { background: #f59e0b; }
    .badge.computer { background: #ef4444; }
    
    /* Mobile-friendly progress section */
    .subject-progress-mobile {
      display: flex;
      align-items: center;
      gap: 15px;
      width: 100%;
      margin-top: 10px;
      justify-content: space-between;
    }
    
    .progress-wrap {
      display: flex;
      gap: 15px;
      align-items: center;
      flex: 1;
    }
    
    .progress-bar {
      height: 12px;
      flex: 1;
      max-width: 150px;
      background: rgba(0,0,0,0.1);
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent-3));
      width: 0%;
      transition: width 1s cubic-bezier(0.22, 0.61, 0.36, 1);
    }
    
    .percent {
      font-size: 0.95rem;
      color: var(--muted);
      width: 60px;
      text-align: right;
      font-weight: 700;
      font-family: var(--font-family);
    }
    
    .toggle-btn {
      padding: 8px 16px;
      background: rgba(255,255,255,0.1);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      cursor: pointer;
      font-weight: 600;
      font-size: 0.85rem;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .toggle-btn:hover {
      background: var(--accent);
      color: white;
    }
    
    .toggle-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .toggle-btn:hover::after {
      left: 120%;
    }
    
    /* ===== FIXED TOPICS CONTAINER ===== */
    .topics {
      padding: 15px 20px;
      display: grid;
      gap: 12px;
      max-height: 400px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--accent) rgba(255,255,255,0.05);
    }
    
    .topic {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      padding: 15px;
      border-radius: 16px;
      background: rgba(255,255,255,0.04);
      border: 1px solid var(--border);
      transition: all 0.3s ease;
    }
    
    .topic:hover {
      background: rgba(255,255,255,0.08);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
    
    .topic input {
      width: 22px;
      height: 22px;
      cursor: pointer;
      transform: translateY(3px);
      accent-color: var(--accent);
    }
    
    .topic label {
      cursor: pointer;
      line-height: 1.5;
      flex: 1;
      padding-right: 10px;
      margin: 5px 0;
      font-family: var(--font-family);
    }
    
    .topic small {
      display: block;
      color: var(--muted);
      margin-top: 8px;
      font-size: 0.9rem;
      margin: 8px 0 0 0;
      font-family: var(--font-family);
    }
    
    .weight {
      margin-left: auto;
      font-size: 0.85rem;
      color: var(--accent);
      background: rgba(0,0,0,0.1);
      padding: 5px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-weight: 700;
      min-width: 60px;
      text-align: center;
      font-family: var(--font-family);
    }
    
    /* Star ratings */
    .stars {
      margin-left: 10px;
      color: #fbbf24;
      font-size: 0.9rem;
    }
    
    .stars.three-stars::after { content: " ★★★"; }
    .stars.two-stars::after { content: " ★★"; }
    .stars.one-star::after { content: " ★"; }
    
    /* ===== Charts ===== */
    .charts {
      display: grid;
      gap: 25px;
      text-align: center;
    }
    
    .overall-chart {
      margin-bottom: 30px;
    }
    
    .overall-donut {
      width: 240px;
      height: 240px;
      display: block;
      margin: 0 auto;
    }
    
    .overall-donut text {
      fill: var(--text);
      font-size: 28px;
      font-weight: 900;
      font-family: var(--font-family);
    }
    
    .subject-charts {
      display: flex;
      flex-direction: row;
      justify-content: space-around;
      gap: 20px;
      flex-wrap: wrap;
    }
    
    .chart-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      min-width: 180px;
      padding: 20px;
      border-radius: 18px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .chart-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    }
    
    .donut {
      width: 120px;
      height: 120px;
    }
    
    .donut text {
      fill: var(--text);
      font-size: 16px;
      font-weight: 800;
      font-family: var(--font-family);
    }
    
    .legend {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 15px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.95rem;
      color: var(--muted);
      font-family: var(--font-family);
    }
    
    .dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
    }
    
    .dot.quantitative { background: #3b82f6; }
    .dot.english { background: #8b5cf6; }
    .dot.reasoning { background: #10b981; }
    .dot.general-awareness { background: #f59e0b; }
    .dot.computer { background: #ef4444; }
    .dot.todo { background: var(--border); }
    .dot.done { background: var(--accent-3); }
    
    .subject-names {
      margin-top: 8px;
      font-size: 1.1rem;
      font-weight: 800;
      color: var(--accent);
      font-family: var(--font-family);
    }
    
    /* ===== Modern Subject Selector ===== */
    .subject-selector-container {
      margin: 20px 0;
    }
    
    .subject-selector-title {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: var(--accent);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: var(--font-family);
    }
    
    .subject-selector {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .subject-selector-btn {
      padding: 10px 16px;
      border-radius: 12px;
      border: 2px solid var(--border);
      background: rgba(255,255,255,0.05);
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
      font-size: 0.9rem;
      font-family: var(--font-family);
    }
    
    .subject-selector-btn.active {
      border-color: var(--accent);
      background: var(--accent);
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
    }
    
    .subject-selector-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .subject-selector-btn:hover::after {
      left: 120%;
    }
    
    /* ===== Circular Subject Charts ===== */
    .subject-chart-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      padding: 20px;
    }
    
    .subject-donut-chart {
      width: 200px;
      height: 200px;
      position: relative;
      margin: 0 auto;
    }
    
    .subject-donut-chart svg {
      width: 100%;
      height: 100%;
      transform: rotate(-90deg);
    }
    
    .subject-chart-percentage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      font-weight: 900;
      color: var(--accent);
      text-shadow: 0 2px 5px rgba(0,0,0,0.1);
      font-family: var(--font-family);
    }
    
    /* ===== Mock Analysis Section ===== */
    .cbt-container {
      display: grid;
      gap: 25px;
      grid-template-columns: 1fr 1fr;
    }
    
    @media (max-width: 768px) {
      .cbt-container {
        grid-template-columns: 1fr;
      }
    }
    
    .cbt-card {
      grid-column: 1 / -1;
    }
    
    .cbt-selection {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .cbt-type-btn {
      padding: 12px 18px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      flex: 1;
      min-width: 140px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .cbt-type-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }
    
    .cbt-type-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .cbt-type-btn:hover::after {
      left: 120%;
    }
    
    .test-type-selection {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .test-type-btn {
      padding: 10px 15px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .test-type-btn.active {
      background: var(--accent-3);
      border-color: var(--accent-3);
      color: white;
    }
    
    .test-type-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .test-type-btn:hover::after {
      left: 120%;
    }
    
    .cbt-form {
      display: grid;
      gap: 15px;
      margin-top: 20px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .form-group label {
      font-weight: 600;
      color: var(--muted);
      font-family: var(--font-family);
    }
    
    .form-group input, .form-group select {
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.05);
      color: var(--text);
      font-size: 1rem;
      font-family: var(--font-family);
    }
    
    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    
    /* ===== Test History Modal ===== */
    .history-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .history-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .history-content {
      background: var(--gradient-card);
      border-radius: 24px;
      padding: 30px;
      text-align: center;
      max-width: 900px;
      width: 95%;
      max-height: 85vh;
      border: 1px solid var(--border);
      box-shadow: 0 30px 60px rgba(0,0,0,0.5);
      position: relative;
      overflow: hidden;
    }
    
    .history-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient);
    }
    
    .history-content h2 {
      font-size: 1.8rem;
      margin-bottom: 20px;
      color: var(--accent);
      font-family: var(--font-family);
    }
    
    .history-table-container {
      max-height: 60vh;
      overflow-y: auto;
      margin: 20px 0;
      border-radius: 12px;
      border: 1px solid var(--border);
    }
    
    .history-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .history-table thead {
      position: sticky;
      top: 0;
      background: var(--card);
      z-index: 10;
    }
    
    .history-table th {
      padding: 12px;
      background: var(--accent);
      color: white;
      text-align: left;
      font-weight: 600;
      border: 1px solid var(--border);
      font-family: var(--font-family);
    }
    
    .history-table td {
      padding: 12px;
      border: 1px solid var(--border);
      text-align: left;
      font-family: var(--font-family);
    }
    
    .history-table tr:nth-child(even) {
      background: rgba(255,255,255,0.05);
    }
    
    .history-table tr:hover {
      background: rgba(255,255,255,0.1);
    }
    
    .close-history {
      padding: 12px 30px;
      background: var(--accent);
      border: none;
      border-radius: 12px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.3s ease;
      display: block;
      margin: 20px auto 0;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .close-history:hover {
      transform: translateY(-3px);
    }
    
    .close-history::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .close-history:hover::after {
      left: 120%;
    }
    
    /* ===== Congratulations Modal ===== */
    .congrats-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .congrats-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .congrats-content {
      background: var(--gradient-card);
      border-radius: 24px;
      padding: 40px;
      text-align: center;
      max-width: 500px;
      width: 90%;
      border: 1px solid var(--border);
      box-shadow: 0 30px 60px rgba(0,0,0,0.5);
      position: relative;
      overflow: hidden;
    }
    
    .congrats-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient);
    }
    
    .congrats-image {
      width: 200px;
      height: 150px;
      margin: 0 auto 20px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .congrats-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      animation: bounce 2s infinite alternate;
    }
    
    @keyframes bounce {
      0% { transform: translateY(0); }
      100% { transform: translateY(-10px); }
    }
    
    .congrats-content h2 {
      font-size: 2.2rem;
      margin-bottom: 15px;
      color: var(--accent);
      font-family: var(--font-family);
    }
    
    .congrats-content p {
      color: var(--muted);
      font-size: 1.2rem;
      margin-bottom: 25px;
      line-height: 1.6;
      padding: 0 10px;
      font-family: var(--font-family);
    }
    
    /* Continue button को center करने के लिए */
    .congrats-content .button-container {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-top: 20px;
    }
    
    .close-congrats {
      padding: 12px 30px;
      background: var(--accent);
      border: none;
      border-radius: 12px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.3s ease;
      display: inline-block;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .close-congrats:hover {
      transform: translateY(-3px);
    }
    
    .close-congrats::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .close-congrats:hover::after {
      left: 120%;
    }
    
    /* ===== BIG Subject Completion Modal ===== */
    .subject-congrats-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      z-index: 3000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .subject-congrats-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .subject-congrats-content {
      background: var(--gradient-card);
      border-radius: 30px;
      padding: 50px 40px;
      text-align: center;
      max-width: 700px;
      width: 90%;
      border: 3px solid var(--border);
      box-shadow: 0 40px 80px rgba(0,0,0,0.7);
      position: relative;
      overflow: hidden;
      animation: zoomIn 0.5s ease-out;
    }
    
    @keyframes zoomIn {
      0% { transform: scale(0.5); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .subject-congrats-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: var(--gradient);
    }
    
    .subject-congrats-image {
      width: 300px;
      height: 200px;
      margin: 0 auto 30px;
      border-radius: 16px;
      overflow: hidden;
      background: rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 3px solid var(--accent);
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }
    
    .subject-congrats-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      animation: bounce 2s infinite alternate;
    }
    
    .subject-congrats-content h2 {
      font-size: 3rem;
      margin-bottom: 20px;
      color: var(--accent);
      text-shadow: 0 5px 15px rgba(0,0,0,0.2);
      font-family: var(--font-family);
    }
    
    .subject-congrats-content p {
      color: var(--muted);
      font-size: 1.5rem;
      margin-bottom: 30px;
      line-height: 1.6;
      padding: 0 20px;
      font-family: var(--font-family);
    }
    
    /* Continue button को center करने के लिए */
    .subject-congrats-content .button-container {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-top: 20px;
    }
    
    .close-subject-congrats {
      padding: 15px 40px;
      background: var(--gradient);
      border: none;
      border-radius: 16px;
      color: white;
      font-weight: 800;
      font-size: 1.2rem;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 15px 30px rgba(0,0,0,0.3);
      display: inline-block;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .close-subject-congrats:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 25px 50px rgba(0,0,0,0.4);
    }
    
    .close-subject-congrats::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .close-subject-congrats:hover::after {
      left: 120%;
    }
    
    /* ===== Graph Controls ===== */
    .graph-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .graph-btn {
      padding: 10px 18px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .graph-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }
    
    .graph-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .graph-btn:hover::after {
      left: 120%;
    }
    
    /* ===== CBT Toggle for Graphs ===== */
    .graph-cbt-toggle {
      display: flex;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 20px;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .graph-cbt-btn {
      flex: 1;
      padding: 10px;
      text-align: center;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .graph-cbt-btn.active {
      background: var(--accent);
      color: white;
    }
    
    .graph-cbt-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .graph-cbt-btn:hover::after {
      left: 120%;
    }
    
    .graph-info {
      font-size: 0.85rem;
      color: var(--muted);
      text-align: center;
      margin-top: -10px;
      margin-bottom: 15px;
      font-style: italic;
      font-family: var(--font-family);
    }
    
    /* ===== Reset Confirmation ===== */
    .reset-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .reset-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .reset-content {
      background: var(--gradient-card);
      border-radius: 24px;
      padding: 40px;
      text-align: center;
      max-width: 500px;
      width: 90%;
      border: 1px solid var(--border);
      box-shadow: 0 30px 60px rgba(0,0,0,0.5);
    }
    
    .reset-content h2 {
      font-size: 1.8rem;
      margin-bottom: 15px;
      color: var(--danger);
      font-family: var(--font-family);
    }
    
    .reset-content p {
      color: var(--muted);
      margin-bottom: 25px;
      line-height: 1.6;
      padding: 0 10px;
      font-family: var(--font-family);
    }
    
    .reset-confirm-input {
      padding: 12px 16px;
      border-radius: 12px;
      border: 2px solid var(--border);
      background: rgba(255,255,255,0.05);
      color: var(--text);
      font-size: 1rem;
      width: 100%;
      margin-bottom: 20px;
      -webkit-text-security: disc;
      text-security: disc;
      font-family: monospace;
      letter-spacing: 2px;
      user-select: none;
    }
    
    .reset-confirm-input:focus {
      outline: none;
      border-color: var(--danger);
    }
    
    .reset-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }
    
    /* ===== Performance Subject Buttons ===== */
    .performance-subject-buttons {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .performance-subject-btn {
      padding: 12px 18px;
      background: rgba(255,255,255,0.05);
      border: 2px solid var(--border);
      border-radius: 12px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .performance-subject-btn.active {
      border-color: var(--accent);
      background: var(--accent);
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
    }
    
    .performance-subject-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .performance-subject-btn:hover::after {
      left: 120%;
    }
    
    /* ===== BIGGER No Data Image ===== */
    .no-data-container {
      text-align: center;
      padding: 40px 20px;
    }
    
    .no-data-image {
      width: 400px;
      height: 300px;
      margin: 0 auto 20px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(255,255,255,0.05);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .no-data-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    /* ===== Graph View Switch ===== */
    .graph-view-switch {
      display: flex;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 4px;
      margin: 20px 0;
    }
    
    .view-btn {
      flex: 1;
      padding: 12px;
      text-align: center;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .view-btn.active {
      background: var(--accent);
      color: white;
    }
    
    .view-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .view-btn:hover::after {
      left: 120%;
    }
    
    /* Settings buttons - FIXED */
    .settings-btn {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.05);
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      text-align: left;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .settings-btn.active {
      background: var(--accent);
      color: white;
    }
    
    .settings-btn:hover {
      background: var(--accent);
      transform: translateX(5px);
    }
    
    .settings-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .settings-btn:hover::after {
      left: 120%;
    }
    
    .settings-content {
      padding: 15px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      margin-bottom: 15px;
      display: none;
    }
    
    .settings-content.active {
      display: block;
    }
    
    /* Chart canvas */
    .chart-canvas {
      width: 100% !important;
      height: 300px !important;
    }
    
    /* Additional margin for better spacing */
    .cbt-form, .graph-controls, .cbt-selection, .test-type-selection {
      margin-bottom: 25px;
    }
    
    /* Center all continue buttons */
    .center-button {
      display: block;
      margin: 20px auto;
    }
    
    /* NEW: Average Score Display */
    .avg-score-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .avg-score-card {
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--border);
      transition: transform 0.3s ease;
    }
    
    .avg-score-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .avg-score-value {
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--accent);
      margin: 10px 0;
      font-family: var(--font-family);
    }
    
    .avg-score-label {
      font-size: 0.9rem;
      color: var(--muted);
      line-height: 1.4;
      font-family: var(--font-family);
    }
    
    /* NEW: History Button */
    .history-btn {
      background: var(--accent-2);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 20px auto;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .history-btn:hover {
      background: var(--accent-3);
      transform: translateY(-3px);
    }
    
    .history-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .history-btn:hover::after {
      left: 120%;
    }
    
    /* NEW: Mock Test History Item */
    .history-item {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 15px;
      margin: 10px 0;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      cursor: pointer;
      font-family: var(--font-family);
    }
    
    .history-item:hover {
      background: rgba(255,255,255,0.1);
      transform: translateY(-3px);
    }
    
    /* NEW: Full Test Subject Toggle */
    .full-test-toggle {
      display: flex;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 20px;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .full-test-btn {
      flex: 1;
      padding: 10px;
      text-align: center;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.85rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .full-test-btn.active {
      background: var(--accent);
      color: white;
    }
    
    .full-test-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .full-test-btn:hover::after {
      left: 120%;
    }
    
    /* Test Data Saved Congratulations Modal - ENHANCED */
    .test-congrats-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      z-index: 2500;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .test-congrats-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .test-congrats-content {
      background: var(--gradient-card);
      border-radius: 30px;
      padding: 50px 40px;
      text-align: center;
      max-width: 650px;
      width: 90%;
      border: 3px solid var(--border);
      box-shadow: 0 40px 80px rgba(0,0,0,0.7);
      position: relative;
      overflow: hidden;
      animation: zoomIn 0.5s ease-out;
    }
    
    .test-congrats-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: var(--gradient);
    }
    
    .test-congrats-image {
      width: 400px;
      height: 250px;
      margin: 0 auto 30px;
      border-radius: 16px;
      overflow: hidden;
      background: rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 3px solid var(--accent);
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }
    
    .test-congrats-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      animation: bounce 2s infinite alternate;
    }
    
    .test-congrats-content h2 {
      font-size: 2.8rem;
      margin-bottom: 20px;
      color: var(--accent);
      text-shadow: 0 5px 15px rgba(0,0,0,0.2);
      font-family: var(--font-family);
    }
    
    .test-congrats-content p {
      color: var(--muted);
      font-size: 1.5rem;
      margin-bottom: 30px;
      line-height: 1.6;
      padding: 0 20px;
      font-family: var(--font-family);
    }
    
    .test-congrats-content .button-container {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-top: 20px;
    }
    
    .close-test-congrats {
      padding: 15px 40px;
      background: var(--gradient);
      border: none;
      border-radius: 16px;
      color: white;
      font-weight: 800;
      font-size: 1.2rem;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 15px 30px rgba(0,0,0,0.3);
      display: inline-block;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .close-test-congrats:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 25px 50px rgba(0,0,0,0.4);
    }
    
    .close-test-congrats::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 30%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      transition: all 0.8s ease;
    }
    
    .close-test-congrats:hover::after {
      left: 120%;
    }
    
    /* Latest Performance Selector */
    .latest-performance-selector {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
      padding: 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      border: 1px solid var(--border);
    }
    
    .performance-tier-selector {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    
    .performance-tier-btn {
      padding: 10px 20px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .performance-tier-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }
    
    .performance-test-type-selector {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .performance-test-type-btn {
      padding: 8px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      position: relative;
      overflow: hidden;
      font-family: var(--font-family);
    }
    
    .performance-test-type-btn.active {
      background: var(--accent-3);
      border-color: var(--accent-3);
      color: white;
    }
    
    /* Form validation styles */
    .form-group.required label::after {
      content: " *";
      color: var(--danger);
    }
    
    .error-message {
      color: var(--danger);
      font-size: 0.85rem;
      margin-top: 5px;
      display: none;
    }
    
    .error-message.show {
      display: block;
    }
    
    input.error {
      border-color: var(--danger) !important;
    }
    
    /* Loading Spinner */
    .loading-spinner {
      display: none;
      width: 40px;
      height: 40px;
      border: 4px solid var(--border);
      border-top: 4px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* ===== Footer ===== */
    footer {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 0.9rem;
      font-family: var(--font-family);
      margin-top: 20px;
    }
    
    .creator {
      color: var(--accent);
      font-weight: 700;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .welcome-content {
        padding: 30px 20px;
        margin: 15px;
      }
      
      .welcome-content h1 {
        font-size: 2.5rem;
      }
      
      .welcome-logo {
        width: 150px;
        height: 150px;
      }
      
      .titles h1 {
        font-size: 1.4rem;
      }
      
      .grid {
        gap: 20px;
      }
      
      /* Drawer को mobile पर 85% width दी */
      .drawer {
        width: 85%;
        max-width: 85%;
      }
      
      .subject-selector-btn, .performance-subject-btn {
        padding: 8px 12px;
        font-size: 0.85rem;
      }
      
      .subject-congrats-content {
        padding: 30px 20px;
      }
      
      .subject-congrats-content h2 {
        font-size: 2.2rem;
      }
      
      .subject-congrats-image {
        width: 250px;
        height: 150px;
      }
      
      body {
        padding-bottom: 65px;
      }
      
      .no-data-image {
        width: 300px;
        height: 225px;
      }
      
      .history-content {
        padding: 20px;
      }
      
      .history-table {
        font-size: 0.85rem;
      }
      
      .avg-score-container {
        grid-template-columns: repeat(2, 1fr);
      }
      
      /* FIXED: Mobile पर subject header का layout */
      .subject-header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .subject-progress-mobile {
        display: flex !important;
      }
      
      .subject-controls {
        margin-left: 0;
        width: 100%;
        justify-content: space-between;
        flex-direction: row;
        margin-top: 10px;
      }
      
      .subject-controls button {
        flex: 1;
        max-width: 48%;
        padding: 8px 10px;
        font-size: 0.75rem;
      }
      
      .full-test-toggle {
        flex-direction: column;
      }
      
      .test-congrats-content {
        padding: 30px 20px;
      }
      
      .test-congrats-content h2 {
        font-size: 2rem;
      }
      
      .test-congrats-image {
        width: 300px;
        height: 180px;
      }
      
      .theme-selector {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 480px) {
      .nav-container {
        padding: 8px 0;
      }
      
      .logo {
        width: 60px;
        height: 60px;
      }
      
      .titles h1 {
        font-size: 1.2rem;
      }
      
      .nav-btn {
        width: 40px;
        height: 40px;
      }
      
      .container {
        padding: 0 15px;
      }
      
      .cbt-selection, .test-type-selection, .graph-controls {
        flex-direction: column;
        align-items: center;
      }
      
      .cbt-type-btn, .test-type-btn, .graph-btn {
        width: 100%;
        max-width: 300px;
      }
      
      .nav-tab-btn span {
        display: inline;
      }
      
      .bottom-nav {
        height: 60px;
      }
      
      .no-data-image {
        width: 250px;
        height: 200px;
      }
      
      .avg-score-container {
        grid-template-columns: 1fr;
      }
      
      /* Mobile पर और छोटा किया */
      .subject-controls button {
        padding: 6px 8px;
        font-size: 0.7rem;
      }
      
      .welcome-content h1 {
        font-size: 2.2rem;
      }
      
      .welcome-logo {
        width: 130px;
        height: 130px;
      }
      
      .progress-bar {
        max-width: 120px;
      }
      
      .toggle-btn {
        padding: 6px 12px;
        font-size: 0.8rem;
      }
      
      .test-congrats-content h2 {
        font-size: 1.8rem;
      }
      
      .test-congrats-image {
        width: 250px;
        height: 150px;
      }
      
      .theme-selector {
        grid-template-columns: 1fr;
      }
    }
    
    /* Fix for mobile touch issues */
    @media (hover: none) and (pointer: coarse) {
      button, .nav-btn, .toggle-btn, .subject-selector-btn, .performance-subject-btn {
        min-height: 44px;
      }
      
      input, select {
        font-size: 16px !important;
      }
    }
  </style>
</head>
<body class="theme-light">
  <!-- Animated Background Doodles -->
  <div class="bg-doodle bg-doodle-1"></div>
  <div class="bg-doodle bg-doodle-2"></div>
  <div class="bg-doodle bg-doodle-3"></div>
  <div class="bg-doodle bg-doodle-4"></div>
  <div class="bg-doodle bg-doodle-5"></div>
  <div class="bg-doodle bg-doodle-6"></div>
  
  <!-- Welcome Screen -->
  <div id="welcomeScreen">
    <div class="welcome-content">
      <div class="welcome-logo">
        <img src="https://image2url.com/images/1766116077549-242d5a4d-1dc2-4734-94ac-de602b3ebc2a.png" alt="SSC CGL PRO Logo">
      </div>
      <h1>SSC CGL PRO</h1>
      <p>Smart tool for SSC CGL exam preparation. Track subject-wise progress, analyze mock tests, and improve your performance.</p>
      
      <input type="text" class="name-input" id="studentName" placeholder="Enter your name (e.g., Rahul Sharma)" maxlength="30">
      
      <button class="welcome-btn center-button" id="startTracking">
        <i class="fas fa-rocket"></i> Get Started
      </button>
    </div>
  </div>
  
  <!-- Drawer Overlay -->
  <div class="drawer-overlay" id="drawerOverlay"></div>
  
  <!-- Drawer Menu -->
  <div class="drawer" id="drawer">
    <div class="drawer-header">
      <h2><i class="fas fa-bars"></i> Menu</h2>
      <button class="drawer-close" id="drawerClose">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="drawer-content">
      <div class="drawer-section">
        <h3><i class="fas fa-share-alt"></i> Share</h3>
        <div class="btn-group">
          <button class="drawer-btn" id="shareProgressBtn">
            <i class="fas fa-share"></i> Share Progress
          </button>
          <button class="drawer-btn" id="shareWebsiteBtn">
            <i class="fas fa-external-link-alt"></i> Share Website
          </button>
          <a href="https://t.me/shailuk7" class="social-link" target="_blank">
            <i class="fab fa-telegram"></i>
            <div>
              <strong>Help and Queries</strong>
              <small>Get support and ask questions</small>
            </div>
          </a>
        </div>
      </div>
      
      <div class="drawer-section">
        <h3><i class="fas fa-cog"></i> Settings</h3>
        <button class="settings-btn" id="themeSettingsBtn">
          <span><i class="fas fa-palette"></i> Theme</span>
          <i class="fas fa-chevron-right"></i>
        </button>
        <div class="settings-content" id="themeSettings">
          <div class="theme-selector">
            <button class="theme-btn active" data-theme="light">
              <i class="fas fa-sun"></i> Light
            </button>
            <button class="theme-btn" data-theme="dark">
              <i class="fas fa-moon"></i> Dark
            </button>
            <button class="theme-btn" data-theme="blue">
              <i class="fas fa-water"></i> Blue
            </button>
            <button class="theme-btn" data-theme="green">
              <i class="fas fa-leaf"></i> Green
            </button>
            <button class="theme-btn" data-theme="purple">
              <i class="fas fa-crown"></i> Purple
            </button>
            <button class="theme-btn" data-theme="pink">
              <i class="fas fa-heart"></i> Pink
            </button>
            <button class="theme-btn" data-theme="orange">
              <i class="fas fa-fire"></i> Orange
            </button>
          </div>
        </div>
        
        <button class="settings-btn" id="languageSettingsBtn">
          <span><i class="fas fa-language"></i> Language</span>
          <i class="fas fa-chevron-right"></i>
        </button>
        <div class="settings-content" id="languageSettings">
          <div class="language-toggle">
            <button class="lang-btn active" data-lang="en">English</button>
            <button class="lang-btn" data-lang="hi">हिंदी</button>
          </div>
        </div>
        
        <div class="btn-group" style="margin-top: 15px;">
          <button class="drawer-btn" id="exportBackupBtn">
            <i class="fas fa-file-export"></i> Export Backup
          </button>
          <button class="drawer-btn" id="importBackupBtn">
            <i class="fas fa-file-import"></i> Import Backup
          </button>
          <button class="drawer-btn danger" id="resetBtn">
            <i class="fas fa-trash-alt"></i> Reset Data
          </button>
        </div>
      </div>
      
      <div class="drawer-section">
        <h3><i class="fas fa-info-circle"></i> Information</h3>
        <p style="color: var(--muted); font-size: 0.95rem; line-height: 1.6; margin: 10px 0;">
          SSC CGL PRO is specifically designed for SSC CGL exam preparation. 
          All data is securely stored on your device.
        </p>
        <p style="color: var(--accent); margin-top: 15px; font-weight: 600;">
          <i class="fas fa-heart"></i> Created by: Mr. SHAILENDRA KUSHWAH
        </p>
      </div>
    </div>
  </div>
  
  <!-- Reset Confirmation Modal -->
  <div class="reset-modal" id="resetModal">
    <div class="reset-content">
      <h2><i class="fas fa-exclamation-triangle"></i> Reset Data</h2>
      <p>Are you sure you want to reset all progress and data? This action cannot be undone.</p>
      <p>To confirm, type below: <strong>"RESET MY PROGRESS"</strong></p>
      <input type="text" class="reset-confirm-input" id="resetConfirmInput" placeholder='Type "RESET MY PROGRESS" here' autocomplete="off">
      <div class="reset-buttons">
        <button class="btn-shine" id="resetCancel">Cancel</button>
        <button class="btn-shine" id="resetConfirm" disabled>Reset</button>
      </div>
    </div>
  </div>
  
  <!-- Test History Modal -->
  <div class="history-modal" id="historyModal">
    <div class="history-content">
      <h2><i class="fas fa-history"></i> Test History</h2>
      <div class="history-table-container">
        <table class="history-table" id="historyTable">
          <thead>
            <tr>
              <th>Test Name</th>
              <th>Type</th>
              <th>Tier</th>
              <th>Date</th>
              <th>Total</th>
              <th>Quantitative</th>
              <th>English</th>
              <th>Reasoning</th>
              <th>Awareness</th>
            </tr>
          </thead>
          <tbody id="historyTableBody">
            <!-- History will be populated here -->
          </tbody>
        </table>
      </div>
      <div class="button-container">
        <button class="close-history center-button" id="closeHistory">Close</button>
      </div>
    </div>
  </div>
  
  <!-- Congratulations Modal -->
  <div class="congrats-modal" id="congratsModal">
    <div class="congrats-content">
      <div class="congrats-image">
        <img src="https://image2url.com/images/1765975197197-8aa80c1d-a2b5-4a02-9cea-1ff7fd633603.gif" alt="Celebration GIF">
      </div>
      <h2>Congratulations!</h2>
      <p id="congratsMessage">You have completed a topic! Your hard work will lead you to success.</p>
      <div class="button-container">
        <button class="close-congrats" id="closeCongrats">Continue</button>
      </div>
    </div>
  </div>
  
  <!-- BIG Subject Completion Modal -->
  <div class="subject-congrats-modal" id="subjectCongratsModal">
    <div class="subject-congrats-content">
      <div class="subject-congrats-image">
        <img src="https://image2url.com/images/1765976345459-aeef2c0d-aefc-4950-884c-b98396e811bc.png" alt="Big Trophy">
      </div>
      <h2 id="subjectCongratsTitle">Amazing Achievement!</h2>
      <p id="subjectCongratsMessage">You have successfully completed an entire subject! Your dedication is inspiring.</p>
      <div class="button-container">
        <button class="close-subject-congrats" id="closeSubjectCongrats">Celebrate & Continue</button>
      </div>
    </div>
  </div>
  
  <!-- Test Data Saved Congratulations Modal -->
  <div class="test-congrats-modal" id="testCongratsModal">
    <div class="test-congrats-content">
      <div class="test-congrats-image">
        <img src="https://image2url.com/images/1766104959384-526229c1-deb3-4ac8-949e-300960e18dfd.png" alt="Test Data Saved">
      </div>
      <h2>Your Test Data Has Been Saved!</h2>
      <p>Keep up the good work and continue your preparation journey!</p>
      <div class="button-container">
        <button class="close-test-congrats" id="closeTestCongrats">Continue</button>
      </div>
    </div>
  </div>
  
  <!-- Main App -->
  <div id="mainApp" style="display: none;">
    <header>
      <div class="nav-container">
        <div class="brand">
          <div class="logo">
            <img src="https://image2url.com/images/1766116077549-242d5a4d-1dc2-4734-94ac-de602b3ebc2a.png" alt="SSC CGL PRO Logo">
          </div>
          <div class="titles">
            <h1>SSC CGL PRO</h1>
            <p><span class="greeting" id="greetingText">Welcome</span></p>
          </div>
        </div>
        <div class="nav-controls">
          <button class="nav-btn" id="menuBtn">
            <i class="fas fa-bars"></i>
          </button>
        </div>
      </div>
    </header>
    
    <div class="container">
      <!-- Syllabus Tab -->
      <div class="tab-content active" id="syllabus-tab">
        <div class="grid">
          <!-- Subjects List -->
          <div class="card">
            <h2>
              <i class="fas fa-graduation-cap"></i> Subjects and Topics <span id="totalProgress">(0% Complete)</span>
              <div class="subject-controls">
                <button id="expandAll">
                  <i class="fas fa-expand-alt"></i> Expand All
                </button>
                <button id="collapseAll">
                  <i class="fas fa-compress-alt"></i> Collapse All
                </button>
              </div>
            </h2>
            <div class="body">
              <div id="subjectsContainer"></div>
            </div>
          </div>
          
          <!-- Progress Overview -->
          <div class="card">
            <h2><i class="fas fa-chart-pie"></i> Progress Overview</h2>
            <div class="body charts">
              <!-- Graph View Switch -->
              <div class="graph-view-switch" id="graphViewSwitch">
                <button class="view-btn active" data-view="overall">
                  <i class="fas fa-globe"></i> Overall Syllabus
                </button>
                <button class="view-btn" data-view="subject">
                  <i class="fas fa-book"></i> Subject-wise Graph
                </button>
              </div>
              
              <!-- Overall Graph View -->
              <div id="overallGraphView">
                <div class="overall-chart">
                  <svg class="overall-donut" viewBox="0 0 200 200" aria-label="Overall completion donut">
                    <circle cx="100" cy="100" r="85" fill="none" stroke="var(--border)" stroke-width="25"/>
                    <circle id="donutOverall" cx="100" cy="100" r="85" fill="none" stroke="url(#gradOverall)" stroke-width="25" stroke-linecap="round" stroke-dasharray="534" stroke-dashoffset="534"/>
                    <defs>
                      <linearGradient id="gradOverall" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0%" stop-color="var(--accent)"/>
                        <stop offset="100%" stop-color="var(--accent-3)"/>
                      </linearGradient>
                    </defs>
                    <text x="100" y="105" text-anchor="middle" id="overallText">0%</text>
                  </svg>
                  <div class="legend">
                    <div class="legend-item"><span class="dot done"></span>Completed</div>
                    <div class="legend-item"><span class="dot todo"></span>Remaining</div>
                  </div>
                </div>
              </div>
              
              <!-- Subject Graph View -->
              <div id="subjectGraphView" style="display: none;">
                <div class="subject-selector-container">
                  <div class="subject-selector-title">
                    <i class="fas fa-filter"></i> Select Subject
                  </div>
                  <div class="subject-selector" id="subjectSelector">
                    <!-- Subject buttons will be dynamically generated -->
                  </div>
                </div>
                
                <div class="subject-chart-container" id="selectedSubjectChart">
                  <div class="subject-donut-chart">
                    <svg viewBox="0 0 200 200" id="subjectDonutSvg">
                      <circle cx="100" cy="100" r="85" fill="none" stroke="var(--border)" stroke-width="25"/>
                      <circle id="subjectDonut" cx="100" cy="100" r="85" fill="none" stroke="url(#gradSubject)" stroke-width="25" stroke-linecap="round" stroke-dasharray="534" stroke-dashoffset="534"/>
                      <defs>
                        <linearGradient id="gradSubject" x1="0" y1="0" x2="0" y2="1">
                          <stop offset="0%" stop-color="var(--accent)"/>
                          <stop offset="100%" stop-color="var(--accent-3)"/>
                        </linearGradient>
                      </defs>
                    </svg>
                    <div class="subject-chart-percentage" id="subjectChartPercentage">0%</div>
                  </div>
                  <div class="legend">
                    <div class="legend-item"><span class="dot done"></span>Completed</div>
                    <div class="legend-item"><span class="dot todo"></span>Remaining</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Mock Analysis Tab -->
      <div class="tab-content" id="mock-analysis-tab">
        <div class="card">
          <h2><i class="fas fa-chart-line"></i> Mock Test Analysis</h2>
          <div class="body">
            <!-- Tier Selection -->
            <div class="cbt-selection">
              <button class="cbt-type-btn active" data-cbt="tier1">
                <i class="fas fa-file-alt"></i> Tier 1 (200 marks)
              </button>
              <button class="cbt-type-btn" data-cbt="tier2">
                <i class="fas fa-file-alt"></i> Tier 2 (390 marks)
              </button>
            </div>
            
            <!-- Test Type Selection -->
            <div class="test-type-selection">
              <button class="test-type-btn active" data-test-type="full">
                <i class="fas fa-clipboard-check"></i> Full Test
              </button>
              <button class="test-type-btn" data-test-type="quantitative">
                <i class="fas fa-calculator"></i> Quantitative Aptitude
              </button>
              <button class="test-type-btn" data-test-type="english">
                <i class="fas fa-language"></i> English Language
              </button>
              <button class="test-type-btn" data-test-type="reasoning">
                <i class="fas fa-brain"></i> Reasoning
              </button>
              <button class="test-type-btn" data-test-type="awareness">
                <i class="fas fa-globe-asia"></i> General Awareness
              </button>
            </div>
            
            <div class="cbt-container">
              <div class="card">
                <h3 id="testFormTitle"><i class="fas fa-edit"></i> Full Test Marks Entry</h3>
                <div class="body">
                  <form class="cbt-form" id="cbtForm">
                    <div class="form-group required">
                      <label for="testName">Test Name:</label>
                      <input type="text" id="testName" placeholder="e.g., Mock Test 1, Previous Year Paper" required>
                      <div class="error-message" id="testNameError">Test name is required</div>
                    </div>
                    
                    <div class="form-group required">
                      <label for="testDate">Date:</label>
                      <input type="date" id="testDate" required>
                      <div class="error-message" id="testDateError">Date is required</div>
                    </div>
                    
                    <!-- Full Test Fields (Initially visible) -->
                    <div id="fullTestFields">
                      <div class="form-row">
                        <div class="form-group required">
                          <label for="quantitativeMarks">Quantitative Aptitude (marks):</label>
                          <input type="number" id="quantitativeMarks" min="0" placeholder="Enter marks" required>
                          <div class="error-message" id="quantitativeError">This field is required for full test</div>
                        </div>
                        <div class="form-group required">
                          <label for="englishMarks">English Language (marks):</label>
                          <input type="number" id="englishMarks" min="0" placeholder="Enter marks" required>
                          <div class="error-message" id="englishError">This field is required for full test</div>
                        </div>
                      </div>
                      <div class="form-row">
                        <div class="form-group required">
                          <label for="reasoningMarks">Reasoning (marks):</label>
                          <input type="number" id="reasoningMarks" min="0" placeholder="Enter marks" required>
                          <div class="error-message" id="reasoningError">This field is required for full test</div>
                        </div>
                        <div class="form-group required">
                          <label for="awarenessMarks">General Awareness (marks):</label>
                          <input type="number" id="awarenessMarks" min="0" placeholder="Enter marks" required>
                          <div class="error-message" id="awarenessError">This field is required for full test</div>
                        </div>
                      </div>
                      <div class="form-group required">
                        <label for="accuracy">Accuracy (%):</label>
                        <input type="number" id="accuracy" min="0" max="100" placeholder="0-100" step="0.1" required>
                        <div class="error-message" id="accuracyError">Accuracy is required for full test</div>
                      </div>
                      <div class="form-group">
                        <label for="totalMarks">Total Marks (auto):</label>
                        <input type="number" id="totalMarks" placeholder="Calculated automatically" readonly>
                      </div>
                    </div>
                    
                    <!-- Sectional Test Fields (Initially hidden) -->
                    <div id="sectionalTestFields" style="display: none;">
                      <div class="form-group required">
                        <label id="sectionalMarksLabel">Marks:</label>
                        <input type="number" id="sectionalMarks" min="0" placeholder="Enter marks" required>
                        <div class="error-message" id="sectionalMarksError">Marks are required</div>
                      </div>
                    </div>
                    
                    <div class="loading-spinner" id="formLoading"></div>
                    
                    <button type="submit" class="btn-shine center-button" id="submitTestBtn">
                      <i class="fas fa-save"></i> Save & Update Graphs
                    </button>
                  </form>
                  
                  <!-- History Button -->
                  <button class="history-btn center-button" id="showHistoryBtn">
                    <i class="fas fa-history"></i> View Test History
                  </button>
                </div>
              </div>
              
              <div class="card">
                <h3><i class="fas fa-trophy"></i> Latest Performance</h3>
                <div class="body">
                  <!-- Performance Selector -->
                  <div class="latest-performance-selector">
                    <div class="performance-tier-selector">
                      <button class="performance-tier-btn active" data-tier="any">
                        <i class="fas fa-star"></i> Latest Any Tier
                      </button>
                      <button class="performance-tier-btn" data-tier="tier1">
                        <i class="fas fa-file-alt"></i> Tier 1
                      </button>
                      <button class="performance-tier-btn" data-tier="tier2">
                        <i class="fas fa-file-alt"></i> Tier 2
                      </button>
                    </div>
                    <div class="performance-test-type-selector">
                      <button class="performance-test-type-btn active" data-type="any">
                        Any Type
                      </button>
                      <button class="performance-test-type-btn" data-type="full">
                        Full Test
                      </button>
                      <button class="performance-test-type-btn" data-type="quantitative">
                        Quantitative
                      </button>
                      <button class="performance-test-type-btn" data-type="english">
                        English
                      </button>
                      <button class="performance-test-type-btn" data-type="reasoning">
                        Reasoning
                      </button>
                      <button class="performance-test-type-btn" data-type="awareness">
                        Awareness
                      </button>
                    </div>
                  </div>
                  
                  <div id="latestPerformance">
                    <div class="no-data-container">
                      <div class="no-data-image">
                        <img src="https://image2url.com/images/1765986538625-dc51de7a-19d5-4f09-9c44-b96d1a48e991.gif" alt="No Data Available">
                      </div>
                      <p style="color: var(--muted); margin: 10px 0;">No test data yet. Add your first test entry.</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Graph 1: Full Test Performance -->
              <div class="card cbt-card">
                <h3><i class="fas fa-chart-line"></i> Full Test Performance</h3>
                <div class="body">
                  <div class="graph-cbt-toggle" id="graph1CbtToggle">
                    <button class="graph-cbt-btn active" data-cbt="tier1">
                      <i class="fas fa-file-alt"></i> Tier 1
                    </button>
                    <button class="graph-cbt-btn" data-cbt="tier2">
                      <i class="fas fa-file-alt"></i> Tier 2
                    </button>
                  </div>
                  
                  <!-- Full Test Subject Toggle -->
                  <div class="full-test-toggle" id="fullTestToggle">
                    <button class="full-test-btn active" data-view="total">
                      <i class="fas fa-chart-line"></i> Total Marks
                    </button>
                    <button class="full-test-btn" data-view="quantitative">
                      <i class="fas fa-calculator"></i> Quantitative
                    </button>
                    <button class="full-test-btn" data-view="english">
                      <i class="fas fa-language"></i> English
                    </button>
                    <button class="full-test-btn" data-view="reasoning">
                      <i class="fas fa-brain"></i> Reasoning
                    </button>
                    <button class="full-test-btn" data-view="awareness">
                      <i class="fas fa-globe-asia"></i> Awareness
                    </button>
                  </div>
                  
                  <p class="graph-info" id="fullTestGraphInfo">Shows full test scores and accuracy</p>
                  <div id="fullTestGraphContainer">
                    <canvas id="fullTestChart" class="chart-canvas"></canvas>
                  </div>
                  <div id="fullTestNoData" style="display: none;">
                    <div class="no-data-container">
                      <div class="no-data-image">
                        <img src="https://image2url.com/images/1765986538625-dc51de7a-19d5-4f09-9c44-b96d1a48e991.gif" alt="No Data Available">
                      </div>
                      <p style="color: var(--muted); margin: 10px 0;">No full test data available for selected Tier.</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Graph 2: Subject-wise Performance -->
              <div class="card cbt-card">
                <h3><i class="fas fa-chart-bar"></i> Subject-wise Performance</h3>
                <div class="body">
                  <div class="graph-cbt-toggle" id="graph2CbtToggle">
                    <button class="graph-cbt-btn active" data-cbt="tier1">
                      <i class="fas fa-file-alt"></i> Tier 1
                    </button>
                    <button class="graph-cbt-btn" data-cbt="tier2">
                      <i class="fas fa-file-alt"></i> Tier 2
                    </button>
                  </div>
                  <p class="graph-info">Sectional test data only (full test marks not included)</p>
                  <div class="performance-subject-buttons" id="subjectGraphButtons">
                    <button class="performance-subject-btn active" data-subject="quantitative">
                      <i class="fas fa-calculator"></i> Quantitative Aptitude
                    </button>
                    <button class="performance-subject-btn" data-subject="english">
                      <i class="fas fa-language"></i> English Language
                    </button>
                    <button class="performance-subject-btn" data-subject="reasoning">
                      <i class="fas fa-brain"></i> Reasoning
                    </button>
                    <button class="performance-subject-btn" data-subject="awareness">
                      <i class="fas fa-globe-asia"></i> General Awareness
                    </button>
                  </div>
                  <div id="subjectGraphContainer">
                    <canvas id="subjectChart" class="chart-canvas"></canvas>
                  </div>
                  <div id="subjectNoData" style="display: none;">
                    <div class="no-data-container">
                      <div class="no-data-image">
                        <img src="https://image2url.com/images/1765986538625-dc51de7a-19d5-4f09-9c44-b96d1a48e991.gif" alt="No Data Available">
                      </div>
                      <p style="color: var(--muted); margin: 10px 0;">No subject test data available for selected Tier.</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Graph 3: Accuracy Analysis -->
              <div class="card cbt-card">
                <h3><i class="fas fa-bullseye"></i> Accuracy Analysis</h3>
                <div class="body">
                  <div class="graph-cbt-toggle" id="graph3CbtToggle">
                    <button class="graph-cbt-btn active" data-cbt="tier1">
                      <i class="fas fa-file-alt"></i> Tier 1
                    </button>
                    <button class="graph-cbt-btn" data-cbt="tier2">
                      <i class="fas fa-file-alt"></i> Tier 2
                    </button>
                  </div>
                  <p class="graph-info">Accuracy from full tests only</p>
                  <div id="accuracyGraphContainer">
                    <canvas id="accuracyChart" class="chart-canvas"></canvas>
                  </div>
                  <div id="accuracyNoData" style="display: none;">
                    <div class="no-data-container">
                      <div class="no-data-image">
                        <img src="https://image2url.com/images/1765986538625-dc51de7a-19d5-4f09-9c44-b96d1a48e991.gif" alt="No Data Available">
                      </div>
                      <p style="color: var(--muted); margin: 10px 0;">No accuracy data available for selected Tier.</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Average Scores Card -->
              <div class="card cbt-card">
                <h3><i class="fas fa-chart-pie"></i> Average Scores</h3>
                <div class="body">
                  <div class="avg-score-container" id="avgScoreContainer">
                    <!-- Average scores will be populated here -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Bottom Navigation Bar -->
    <div class="bottom-nav">
      <div class="nav-tabs">
        <button class="nav-tab-btn active" data-tab="syllabus">
          <i class="fas fa-book-open"></i> <span>Tracker</span>
        </button>
        <button class="nav-tab-btn" data-tab="mock-analysis">
          <i class="fas fa-chart-line"></i> <span>Analysis</span>
        </button>
      </div>
    </div>
    
    <footer>
      © <span class="creator">SSC CGL PRO 2026</span> — SSC CGL Syllabus Tracker
    </footer>
  </div>
  
  <!-- Hidden file input for import -->
  <input type="file" id="importFile" accept=".json" style="display:none">
  
  <script>
    // ========== CONFIGURATION ==========
    const CONFIG = {
      appName: "SSC CGL PRO",
      appVersion: "2026.5.2",
      
      // SSC CGL Tier Configuration - CORRECTED
      cbtConfig: {
        tier1: {
          totalMarks: 200,
          sections: {
            quantitative: { maxMarks: 50 },
            english: { maxMarks: 50 },
            reasoning: { maxMarks: 50 },
            awareness: { maxMarks: 50 }
          }
        },
        tier2: {
          totalMarks: 390,
          sections: {
            quantitative: { maxMarks: 90 },
            english: { maxMarks: 135 },
            reasoning: { maxMarks: 90 },
            awareness: { maxMarks: 75 }
          }
        }
      },
      
      // SSC CGL Subjects with expanded topics
      subjects: [
        {
          id: "quantitative",
          title: { en: "Quantitative Aptitude", hi: "मात्रात्मक अभियोग्यता" },
          colorClass: "quantitative",
          weight: 1,
          topics: [
            { id:"numSys", name: { en:"Number System", hi:"संख्या प्रणाली" }, hint: { en:"Number system, decimals, fractions, LCM and HCF", hi:"संख्या प्रणाली, दशमलव, भिन्न, लघुत्तम समापवर्त्य और महत्तम समापवर्तक" }, weight:1, stars: 3 },
            { id:"ratio", name: { en:"Ratio and Proportion", hi:"अनुपात और समानुपात" }, hint: { en:"Ratio and proportion", hi:"अनुपात और समानुपात" }, weight:1, stars: 2 },
            { id:"percent", name: { en:"Percentage", hi:"प्रतिशत" }, hint: { en:"Percentage", hi:"प्रतिशत" }, weight:1, stars: 3 },
            { id:"mensuration", name: { en:"Mensuration", hi:"क्षेत्रमिति" }, hint: { en:"Mensuration", hi:"क्षेत्रमिति" }, weight:1, stars: 2 },
            { id:"timeWork", name: { en:"Time and Work", hi:"समय और कार्य" }, hint: { en:"Time and work", hi:"समय और कार्य" }, weight:1, stars: 3 },
            { id:"speedTime", name: { en:"Speed, Time and Distance", hi:"गति, समय और दूरी" }, hint: { en:"Speed, time and distance", hi:"गति, समय और दूरी" }, weight:1, stars: 3 },
            { id:"simpleInterest", name: { en:"Simple and Compound Interest", hi:"साधारण और चक्रवृद्धि ब्याज" }, hint: { en:"Simple and compound interest", hi:"साधारण और चक्रवृद्धि ब्याज" }, weight:1, stars: 2 },
            { id:"profitLoss", name: { en:"Profit and Loss", hi:"लाभ और हानि" }, hint: { en:"Profit and loss", hi:"लाभ और हानि" }, weight:1, stars: 2 },
            { id:"dataInterpretation", name: { en:"Data Interpretation", hi:"डेटा व्याख्या" }, hint: { en:"Data interpretation", hi:"डेटा व्याख्या" }, weight:1, stars: 3 },
            { id:"simplification", name: { en:"Simplification", hi:"सरलीकरण" }, hint: { en:"Simplification", hi:"सरलीकरण" }, weight:1, stars: 2 },
            { id:"algebra", name: { en:"Algebra", hi:"बीजगणित" }, hint: { en:"Algebraic expressions and equations", hi:"बीजीय व्यंजक और समीकरण" }, weight:1, stars: 3 },
            { id:"geometry", name: { en:"Geometry", hi:"ज्यामिति" }, hint: { en:"Lines, angles, triangles, circles", hi:"रेखाएं, कोण, त्रिभुज, वृत्त" }, weight:1, stars: 3 },
            { id:"trigonometry", name: { en:"Trigonometry", hi:"त्रिकोणमिति" }, hint: { en:"Trigonometric ratios and identities", hi:"त्रिकोणमितीय अनुपात और सर्वसमिकाएं" }, weight:1, stars: 2 },
            { id:"statistics", name: { en:"Statistics", hi:"सांख्यिकी" }, hint: { en:"Mean, median, mode, standard deviation", hi:"माध्य, माध्यिका, बहुलक, मानक विचलन" }, weight:1, stars: 2 }
          ]
        },
        {
          id: "english",
          title: { en: "English Language", hi: "अंग्रेजी भाषा" },
          colorClass: "english",
          weight: 1,
          topics: [
            { id:"grammar_tenses", name: { en:"Tenses", hi:"काल" }, hint: { en:"Present, past, future tenses", hi:"वर्तमान, भूत, भविष्य काल" }, weight:1, stars: 3 },
            { id:"grammar_parts", name: { en:"Parts of Speech", hi:"शब्द भेद" }, hint: { en:"Noun, pronoun, verb, adjective, etc.", hi:"संज्ञा, सर्वनाम, क्रिया, विशेषण आदि" }, weight:1, stars: 3 },
            { id:"grammar_voice", name: { en:"Voice", hi:"वाच्य" }, hint: { en:"Active and passive voice", hi:"कर्तृवाच्य और कर्मवाच्य" }, weight:1, stars: 2 },
            { id:"grammar_narration", name: { en:"Narration", hi:"कथन" }, hint: { en:"Direct and indirect speech", hi:"प्रत्यक्ष और अप्रत्यक्ष कथन" }, weight:1, stars: 2 },
            { id:"grammar_agreement", name: { en:"Subject-Verb Agreement", hi:"कर्ता-क्रिया सहमति" }, hint: { en:"Subject-verb agreement rules", hi:"कर्ता-क्रिया सहमति नियम" }, weight:1, stars: 2 },
            { id:"grammar_articles", name: { en:"Articles", hi:"उपपद" }, hint: { en:"Use of a, an, the", hi:"a, an, the का प्रयोग" }, weight:1, stars: 1 },
            { id:"grammar_prepositions", name: { en:"Prepositions", hi:"पूर्वसर्ग" }, hint: { en:"Prepositions and their usage", hi:"पूर्वसर्ग और उनका प्रयोग" }, weight:1, stars: 2 },
            { id:"vocab_synonyms", name: { en:"Synonyms", hi:"पर्यायवाची" }, hint: { en:"Words with similar meanings", hi:"समान अर्थ वाले शब्द" }, weight:1, stars: 3 },
            { id:"vocab_antonyms", name: { en:"Antonyms", hi:"विलोम" }, hint: { en:"Words with opposite meanings", hi:"विपरीत अर्थ वाले शब्द" }, weight:1, stars: 3 },
            { id:"vocab_oneword", name: { en:"One Word Substitution", hi:"एक शब्द प्रतिस्थापन" }, hint: { en:"Single word for phrases", hi:"वाक्यांशों के लिए एक शब्द" }, weight:1, stars: 2 },
            { id:"vocab_idioms", name: { en:"Idioms and Phrases", hi:"मुहावरे और वाक्यांश" }, hint: { en:"Common idioms and their meanings", hi:"सामान्य मुहावरे और उनके अर्थ" }, weight:1, stars: 2 },
            { id:"vocab_spelling", name: { en:"Spelling Check", hi:"वर्तनी जाँच" }, hint: { en:"Correct spelling of words", hi:"शब्दों की सही वर्तनी" }, weight:1, stars: 2 },
            { id:"comprehension", name: { en:"Reading Comprehension", hi:"पठन समझ" }, hint: { en:"Passage reading and answering questions", hi:"अनुच्छेद पढ़ना और प्रश्नों के उत्तर देना" }, weight:1, stars: 3 },
            { id:"errorDetection", name: { en:"Error Detection", hi:"त्रुटि पहचान" }, hint: { en:"Spotting errors in sentences", hi:"वाक्यों में त्रुटियाँ ढूँढना" }, weight:1, stars: 3 },
            { id:"sentenceImprovement", name: { en:"Sentence Improvement", hi:"वाक्य सुधार" }, hint: { en:"Improving given sentences", hi:"दिए गए वाक्यों में सुधार करना" }, weight:1, stars: 2 },
            { id:"fillBlanks", name: { en:"Fill in the Blanks", hi:"रिक्त स्थान भरना" }, hint: { en:"Choosing correct words to fill blanks", hi:"रिक्त स्थान भरने के लिए सही शब्द चुनना" }, weight:1, stars: 2 },
            { id:"paraJumbles", name: { en:"Para Jumbles", hi:"अनुच्छेद जंबल" }, hint: { en:"Rearranging sentences to form coherent paragraph", hi:"सुसंगत अनुच्छेद बनाने के लिए वाक्यों को पुनर्व्यवस्थित करना" }, weight:1, stars: 3 },
            { id:"clozeTest", name: { en:"Cloze Test", hi:"क्लोज टेस्ट" }, hint: { en:"Completing passage with appropriate words", hi:"उपयुक्त शब्दों से अनुच्छेद पूरा करना" }, weight:1, stars: 3 }
          ]
        },
        {
          id: "reasoning",
          title: { en: "Reasoning Ability", hi: "तार्किक योग्यता" },
          colorClass: "reasoning",
          weight: 1,
          topics: [
            { id:"analogies", name: { en:"Analogies", hi:"सादृश्यता" }, hint: { en:"Analogies", hi:"सादृश्यता" }, weight:1, stars: 2 },
            { id:"series", name: { en:"Number and Alphabet Series", hi:"संख्या और वर्णमाला श्रृंखला" }, hint: { en:"Completing number and alphabet series", hi:"संख्या और वर्णमाला श्रृंखला पूरी करना" }, weight:1, stars: 3 },
            { id:"coding", name: { en:"Coding and Decoding", hi:"कोडिंग और डिकोडिंग" }, hint: { en:"Coding and decoding", hi:"कोडिंग और डिकोडिंग" }, weight:1, stars: 3 },
            { id:"mathOps", name: { en:"Mathematical Operations", hi:"गणितीय संक्रियाएं" }, hint: { en:"Mathematical operations", hi:"गणितीय संक्रियाएं" }, weight:1, stars: 2 },
            { id:"similarities", name: { en:"Similarities and Differences", hi:"समानताएं और अंतर" }, hint: { en:"Similarities and differences", hi:"समानताएं और अंतर" }, weight:1, stars: 1 },
            { id:"relationships", name: { en:"Relationships", hi:"संबंध" }, hint: { en:"Relationships", hi:"संबंध" }, weight:1, stars: 1 },
            { id:"analytical", name: { en:"Analytical Reasoning", hi:"विश्लेषणात्मक तर्क" }, hint: { en:"Analytical reasoning", hi:"विश्लेषणात्मक तर्क" }, weight:1, stars: 3 },
            { id:"syllogism", name: { en:"Syllogism", hi:"न्यायवाक्य" }, hint: { en:"Syllogism", hi:"न्यायवाक्य" }, weight:1, stars: 3 },
            { id:"jumbling", name: { en:"Jumbling", hi:"जंबलिंग" }, hint: { en:"Jumbling", hi:"जंबलिंग" }, weight:1, stars: 2 },
            { id:"venn", name: { en:"Venn Diagrams", hi:"वेन आरेख" }, hint: { en:"Venn diagrams", hi:"वेन आरेख" }, weight:1, stars: 2 },
            { id:"puzzle", name: { en:"Puzzle", hi:"पहेली" }, hint: { en:"Puzzle", hi:"पहेली" }, weight:1, stars: 3 },
            { id:"dataSuff", name: { en:"Data Sufficiency", hi:"डेटा पर्याप्तता" }, hint: { en:"Data sufficiency", hi:"डेटा पर्याप्तता" }, weight:1, stars: 2 },
            { id:"statementConcl", name: { en:"Statement-Conclusion", hi:"कथन-निष्कर्ष" }, hint: { en:"Statement-conclusion", hi:"कथन-निष्कर्ष" }, weight:1, stars: 2 },
            { id:"coursesAction", name: { en:"Courses of Action", hi:"कार्रवाई के तरीके" }, hint: { en:"Statement: courses of action", hi:"कथन: कार्रवाई के तरीके" }, weight:1, stars: 1 },
            { id:"decisionMaking", name: { en:"Decision Making", hi:"निर्णय लेना" }, hint: { en:"Decision making", hi:"निर्णय लेना" }, weight:1, stars: 1 },
            { id:"maps", name: { en:"Maps", hi:"मानचित्र" }, hint: { en:"Maps", hi:"मानचित्र" }, weight:1, stars: 1 },
            { id:"graphs", name: { en:"Graph Interpretation", hi:"ग्राफ व्याख्या" }, hint: { en:"Graph interpretation", hi:"ग्राफ व्याख्या" }, weight:1, stars: 2 }
          ]
        },
        {
          id: "general-awareness",
          title: { en: "General Awareness", hi: "सामान्य जागरूकता" },
          colorClass: "general-awareness",
          weight: 1,
          topics: [
            { id:"history_ancient", name: { en:"Ancient History", hi:"प्राचीन इतिहास" }, hint: { en:"Indus Valley, Vedic period, Maurya, Gupta", hi:"सिंधु घाटी, वैदिक काल, मौर्य, गुप्त" }, weight:1, stars: 2 },
            { id:"history_medieval", name: { en:"Medieval History", hi:"मध्यकालीन इतिहास" }, hint: { en:"Delhi Sultanate, Mughal Empire", hi:"दिल्ली सल्तनत, मुगल साम्राज्य" }, weight:1, stars: 2 },
            { id:"history_modern", name: { en:"Modern History", hi:"आधुनिक इतिहास" }, hint: { en:"British rule, freedom struggle", hi:"ब्रिटिश शासन, स्वतंत्रता संग्राम" }, weight:1, stars: 3 },
            { id:"geography_india", name: { en:"Indian Geography", hi:"भारतीय भूगोल" }, hint: { en:"Physical, political, economic geography of India", hi:"भारत का भौतिक, राजनीतिक, आर्थिक भूगोल" }, weight:1, stars: 3 },
            { id:"geography_world", name: { en:"World Geography", hi:"विश्व भूगोल" }, hint: { en:"Continents, oceans, climate, resources", hi:"महाद्वीप, महासागर, जलवायु, संसाधन" }, weight:1, stars: 2 },
            { id:"polity_constitution", name: { en:"Constitution", hi:"संविधान" }, hint: { en:"Preamble, fundamental rights, duties", hi:"प्रस्तावना, मौलिक अधिकार, कर्तव्य" }, weight:1, stars: 3 },
            { id:"polity_parliament", name: { en:"Parliament", hi:"संसद" }, hint: { en:"Lok Sabha, Rajya Sabha, legislative process", hi:"लोकसभा, राज्यसभा, विधायी प्रक्रिया" }, weight:1, stars: 2 },
            { id:"polity_judiciary", name: { en:"Judiciary", hi:"न्यायपालिका" }, hint: { en:"Supreme Court, High Courts, judicial review", hi:"सुप्रीम कोर्ट, हाईकोर्ट, न्यायिक समीक्षा" }, weight:1, stars: 2 },
            { id:"economy_basic", name: { en:"Basic Economics", hi:"मूल अर्थशास्त्र" }, hint: { en:"GDP, inflation, fiscal policy, monetary policy", hi:"जीडीपी, मुद्रास्फीति, राजकोषीय नीति, मौद्रिक नीति" }, weight:1, stars: 3 },
            { id:"economy_india", name: { en:"Indian Economy", hi:"भारतीय अर्थव्यवस्था" }, hint: { en:"Planning, budgets, economic reforms", hi:"योजना, बजट, आर्थिक सुधार" }, weight:1, stars: 3 },
            { id:"science_physics", name: { en:"Physics", hi:"भौतिकी" }, hint: { en:"Laws of motion, energy, optics, electricity", hi:"गति के नियम, ऊर्जा, प्रकाशिकी, विद्युत" }, weight:1, stars: 3 },
            { id:"science_chemistry", name: { en:"Chemistry", hi:"रसायन विज्ञान" }, hint: { en:"Elements, compounds, chemical reactions", hi:"तत्व, यौगिक, रासायनिक अभिक्रियाएं" }, weight:1, stars: 2 },
            { id:"science_biology", name: { en:"Biology", hi:"जीवविज्ञान" }, hint: { en:"Human body, plants, animals, diseases", hi:"मानव शरीर, पौधे, जानवर, रोग" }, weight:1, stars: 3 },
            { id:"current_national", name: { en:"National Current Affairs", hi:"राष्ट्रीय समसामयिक घटनाक्रम" }, hint: { en:"National events, policies, appointments", hi:"राष्ट्रीय घटनाएं, नीतियां, नियुक्तियां" }, weight:1, stars: 3 },
            { id:"current_international", name: { en:"International Current Affairs", hi:"अंतर्राष्ट्रीय समसामयिक घटनाक्रम" }, hint: { en:"Global events, summits, treaties", hi:"वैश्विक घटनाएं, शिखर सम्मेलन, संधियाँ" }, weight:1, stars: 2 },
            { id:"awards", name: { en:"Awards and Honors", hi:"पुरस्कार और सम्मान" }, hint: { en:"National and international awards", hi:"राष्ट्रीय और अंतर्राष्ट्रीय पुरस्कार" }, weight:1, stars: 2 },
            { id:"sports", name: { en:"Sports", hi:"खेल" }, hint: { en:"Sports events, players, awards", hi:"खेल आयोजन, खिलाड़ी, पुरस्कार" }, weight:1, stars: 2 },
            { id:"booksAuthors", name: { en:"Books and Authors", hi:"पुस्तकें और लेखक" }, hint: { en:"Important books and their authors", hi:"महत्वपूर्ण पुस्तकें और उनके लेखक" }, weight:1, stars: 2 },
            { id:"importantDays", name: { en:"Important Days", hi:"महत्वपूर्ण दिवस" }, hint: { en:"National and international days", hi:"राष्ट्रीय और अंतर्राष्ट्रीय दिवस" }, weight:1, stars: 2 }
          ]
        },
        {
          id: "computer",
          title: { en: "Computer Knowledge", hi: "कंप्यूटर ज्ञान" },
          colorClass: "computer",
          weight: 1,
          topics: [
            { id:"computerFundamentals", name: { en:"Computer Fundamentals", hi:"कंप्यूटर मूल बातें" }, hint: { en:"Hardware, software, operating systems", hi:"हार्डवेयर, सॉफ्टवेयर, ऑपरेटिंग सिस्टम" }, weight:1, stars: 3 },
            { id:"msOffice", name: { en:"MS Office", hi:"एमएस ऑफिस" }, hint: { en:"Word, Excel, PowerPoint", hi:"वर्ड, एक्सेल, पावरपॉइंट" }, weight:1, stars: 2 },
            { id:"internet", name: { en:"Internet and Networking", hi:"इंटरनेट और नेटवर्किंग" }, hint: { en:"Internet, email, social media", hi:"इंटरनेट, ईमेल, सोशल मीडिया" }, weight:1, stars: 2 },
            { id:"abbreviations", name: { en:"Computer Abbreviations", hi:"कंप्यूटर संक्षिप्ताक्षर" }, hint: { en:"Computer related abbreviations", hi:"कंप्यूटर से संबंधित संक्षिप्ताक्षर" }, weight:1, stars: 1 },
            { id:"cyberSecurity", name: { en:"Cyber Security", hi:"साइबर सुरक्षा" }, hint: { en:"Virus, hacking, data security", hi:"वायरस, हैकिंग, डेटा सुरक्षा" }, weight:1, stars: 1 },
            { id:"emergingTech", name: { en:"Emerging Technologies", hi:"उभरती प्रौद्योगिकियाँ" }, hint: { en:"Artificial Intelligence, Blockchain, IoT", hi:"कृत्रिम बुद्धिमत्ता, ब्लॉकचेन, आईओटी" }, weight:1, stars: 1 }
          ]
        }
      ],
      
      // Hindi Translations
      translations: {
        en: {
          appName: "SSC CGL PRO",
          welcomeTitle: "SSC CGL PRO",
          welcomeSubtitle: "Smart tool for SSC CGL exam preparation. Track subject-wise progress, analyze mock tests, and improve your performance.",
          namePlaceholder: "Enter your name (e.g., Rahul Sharma)",
          getStarted: "Get Started",
          continue: "Continue",
          subjects: "Subjects and Topics",
          progressOverview: "Progress Overview",
          mockAnalysis: "Mock Analysis",
          syllabusTracker: "Syllabus Tracker",
          overallSyllabus: "Overall Syllabus",
          subjectWiseGraph: "Subject-wise Graph",
          selectSubject: "Select Subject",
          tier1: "Tier 1 (200 marks)",
          tier2: "Tier 2 (390 marks)",
          fullTest: "Full Test",
          quantitative: "Quantitative Aptitude",
          english: "English Language",
          reasoning: "Reasoning",
          generalAwareness: "General Awareness",
          testName: "Test Name:",
          date: "Date:",
          quantitativeMarks: "Quantitative Aptitude (marks):",
          englishMarks: "English Language (marks):",
          reasoningMarks: "Reasoning (marks):",
          awarenessMarks: "General Awareness (marks):",
          accuracy: "Accuracy (%):",
          totalMarks: "Total Marks (auto):",
          marks: "Marks:",
          save: "Save & Update Graphs",
          latestPerformance: "Latest Performance",
          performanceGraphs: "Performance Graphs",
          fullTestGraph: "Full Test",
          quantitativeGraph: "Quantitative Aptitude",
          englishGraph: "English Language",
          reasoningGraph: "Reasoning",
          gsGraph: "General Awareness",
          accuracyGraph: "Accuracy",
          noData: "No test data yet. Add your first test entry.",
          expandAll: "Expand All",
          collapseAll: "Collapse All",
          resetConfirm: "RESET MY PROGRESS",
          resetPlaceholder: 'Type "RESET MY PROGRESS" here',
          shareProgress: "Share Progress",
          shareWebsite: "Share Website",
          generateImage: "Generate Progress Image",
          helpQueries: "Help and Queries",
          exportBackup: "Export Backup",
          importBackup: "Import Backup",
          resetData: "Reset Data",
          createdBy: "Created by: Mr. SHAILENDRA KUSHWAH",
          footerText: "© SSC CGL PRO 2026 — SSC CGL Syllabus Tracker",
          congratulations: "Congratulations!",
          congratsMessage: "You have completed a topic! Your hard work will lead you to success.",
          subjectCongrats: "Amazing Achievement!",
          subjectCongratsMessage: "You have successfully completed an entire subject! Your dedication is inspiring.",
          continueBtn: "Continue",
          celebrateBtn: "Celebrate & Continue",
          completed: "Completed",
          remaining: "Remaining",
          viewHistory: "View Test History",
          testHistory: "Test History",
          avgScore: "Average Score",
          tier1Avg: "Tier 1 Average",
          tier2Avg: "Tier 2 Average",
          overallAvg: "Overall Average",
          fullTests: "Full Tests",
          quantitativeTests: "Quantitative Tests",
          englishTests: "English Tests",
          reasoningTests: "Reasoning Tests",
          awarenessTests: "Awareness Tests",
          tests: "tests",
          percentage: "Percentage",
          downloadImage: "Download Image",
          shareImage: "Share Image",
          closeImage: "Close"
        },
        hi: {
          appName: "एसएससी सीजीएल प्रो",
          welcomeTitle: "एसएससी सीजीएल प्रो",
          welcomeSubtitle: "एसएससी सीजीएल परीक्षा की तैयारी के लिए स्मार्ट टूल। विषय-वार प्रगति ट्रैक करें, मॉक टेस्ट का विश्लेषण करें, और अपने प्रदर्शन में सुधार करें।",
          namePlaceholder: "अपना नाम दर्ज करें (जैसे, राहुल शर्मा)",
          getStarted: "शुरू करें",
          continue: "जारी रखें",
          subjects: "विषय और टॉपिक्स",
          progressOverview: "प्रगति अवलोकन",
          mockAnalysis: "मॉक विश्लेषण",
          syllabusTracker: "पाठ्यक्रम ट्रैकर",
          overallSyllabus: "समग्र पाठ्यक्रम",
          subjectWiseGraph: "विषय-वार ग्राफ",
          selectSubject: "विषय चुनें",
          tier1: "टियर 1 (200 अंक)",
          tier2: "टियर 2 (390 अंक)",
          fullTest: "पूर्ण परीक्षा",
          quantitative: "मात्रात्मक अभियोग्यता",
          english: "अंग्रेजी भाषा",
          reasoning: "तर्कशक्ति",
          generalAwareness: "सामान्य जागरूकता",
          testName: "टेस्ट नाम:",
          date: "तारीख:",
          quantitativeMarks: "मात्रात्मक अभियोग्यता (अंक):",
          englishMarks: "अंग्रेजी भाषा (अंक):",
          reasoningMarks: "तर्कशक्ति (अंक):",
          awarenessMarks: "सामान्य जागरूकता (अंक):",
          accuracy: "सटीकता (%):",
          totalMarks: "कुल अंक (स्वचालित):",
          marks: "अंक:",
          save: "सहेजें और ग्राफ अपडेट करें",
          latestPerformance: "नवीनतम प्रदर्शन",
          performanceGraphs: "प्रदर्शन ग्राफ",
          fullTestGraph: "पूर्ण परीक्षा",
          quantitativeGraph: "मात्रात्मक अभियोग्यता",
          englishGraph: "अंग्रेजी भाषा",
          reasoningGraph: "तर्कशक्ति",
          gsGraph: "सामान्य जागरूकता",
          accuracyGraph: "सटीकता",
          noData: "अभी तक कोई टेस्ट डेटा नहीं है। अपनी पहली टेस्ट एंट्री जोड़ें।",
          expandAll: "सभी विस्तारित करें",
          collapseAll: "सभी संक्षिप्त करें",
          resetConfirm: "मेरी प्रगति रीसेट करें",
          resetPlaceholder: '"मेरी प्रगति रीसेट करें" टाइप करें',
          shareProgress: "प्रगति साझा करें",
          shareWebsite: "वेबसाइट साझा करें",
          generateImage: "प्रगति छवि बनाएं",
          helpQueries: "सहायता और प्रश्न",
          exportBackup: "बैकअप निर्यात करें",
          importBackup: "बैकअप आयात करें",
          resetData: "डेटा रीसेट करें",
          createdBy: "बनाया गया: श्री शैलेंद्र कुशवाह द्वारा",
          footerText: "© एसएससी सीजीएल प्रो 2026 — एसएससी सीजीएल पाठ्यक्रम ट्रैकर",
          congratulations: "बधाई हो!",
          congratsMessage: "आपने एक टॉपिक पूरा कर लिया है! आपकी मेहनत आपको सफलता की ओर ले जाएगी।",
          subjectCongrats: "अद्भुत उपलब्धि!",
          subjectCongratsMessage: "आपने पूरा विषय सफलतापूर्वक पूरा कर लिया है! आपका समर्पण प्रेरणादायक है।",
          continueBtn: "जारी रखें",
          celebrateBtn: "जश्न मनाएं और जारी रखें",
          completed: "पूर्ण",
          remaining: "शेष",
          viewHistory: "टेस्ट इतिहास देखें",
          testHistory: "टेस्ट इतिहास",
          avgScore: "औसत स्कोर",
          tier1Avg: "टियर 1 औसत",
          tier2Avg: "टियर 2 औसत",
          overallAvg: "कुल औसत",
          fullTests: "पूर्ण टेस्ट",
          quantitativeTests: "मात्रात्मक टेस्ट",
          englishTests: "अंग्रेजी टेस्ट",
          reasoningTests: "तर्कशक्ति टेस्ट",
          awarenessTests: "सामान्य जागरूकता टेस्ट",
          tests: "टेस्ट",
          percentage: "प्रतिशत",
          downloadImage: "छवि डाउनलोड करें",
          shareImage: "छवि साझा करें",
          closeImage: "बंद करें"
        }
      }
    };
    
    // ========== GLOBAL VARIABLES ==========
    const STORAGE_KEYS = {
      PROGRESS: "ssc_cgl_progress_v17",
      UI_STATE: "ssc_cgl_ui_state_v17",
      STUDENT_NAME: "ssc_cgl_student_name",
      CBT_RESULTS: "ssc_cgl_results_v17",
      THEME: "ssc_cgl_theme",
      STUDY_LOG: "ssc_cgl_study_log",
      LANGUAGE: "ssc_cgl_language",
      LATEST_PERF_SELECTION: "ssc_cgl_latest_perf_selection"
    };
    
    let savedProgress = JSON.parse(localStorage.getItem(STORAGE_KEYS.PROGRESS) || "{}");
    let savedUIState = JSON.parse(localStorage.getItem(STORAGE_KEYS.UI_STATE) || "{}");
    let cbtResults = JSON.parse(localStorage.getItem(STORAGE_KEYS.CBT_RESULTS) || "[]");
    let studyLog = JSON.parse(localStorage.getItem(STORAGE_KEYS.STUDY_LOG) || "[]");
    let currentTheme = localStorage.getItem(STORAGE_KEYS.THEME) || "light";
    let currentLanguage = localStorage.getItem(STORAGE_KEYS.LANGUAGE) || "en";
    let latestPerformanceSelection = JSON.parse(localStorage.getItem(STORAGE_KEYS.LATEST_PERF_SELECTION) || '{"tier":"any","type":"any"}');
    
    let charts = {
      fullTest: null,
      subject: null,
      accuracy: null
    };
    let currentCBT = "tier1";
    let currentTestType = "full";
    let selectedSubjectForGraph = null;
    let currentGraphCBT = "tier1";
    let selectedSubjectForChart = "quantitative";
    let fullTestGraphView = "total";
    let isSubmitting = false;

    // ========== INITIALIZATION ==========
    function initializeApp() {
      setTheme(currentTheme);
      setLanguage(currentLanguage);
      
      const welcomeScreen = document.getElementById('welcomeScreen');
      const mainApp = document.getElementById('mainApp');
      const nameInput = document.getElementById('studentName');
      const startBtn = document.getElementById('startTracking');
      const studentName = localStorage.getItem(STORAGE_KEYS.STUDENT_NAME) || "";
      
      welcomeScreen.style.display = 'flex';
      mainApp.style.display = 'none';
      
      if (studentName) {
        nameInput.value = studentName;
        nameInput.readOnly = true;
        startBtn.innerHTML = `<i class="fas fa-rocket"></i> ${t('continue')}`;
        
        setTimeout(() => {
          if (document.visibilityState === 'visible') {
            startWelcomeTransition();
          }
        }, 1500);
      } else {
        nameInput.readOnly = false;
        startBtn.innerHTML = `<i class="fas fa-rocket"></i> ${t('getStarted')}`;
      }
      
      startBtn.onclick = () => {
        const name = nameInput.value.trim();
        if (!studentName && !name) {
          alert('Please enter your name!');
          nameInput.focus();
          return;
        }
        
        if (!studentName) {
          localStorage.setItem(STORAGE_KEYS.STUDENT_NAME, name);
        }
        
        startWelcomeTransition();
      };
      
      nameInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          startBtn.click();
        }
      });
      
      function startWelcomeTransition() {
        welcomeScreen.classList.add('hidden');
        setTimeout(() => {
          welcomeScreen.style.display = 'none';
          mainApp.style.display = 'block';
          initializeMainApp();
        }, 800);
      }
    }
    
    function initializeMainApp() {
      updateGreeting();
      renderSubjects();
      updateProgress();
      setupEventListeners();
      initializeCBTForm();
      loadCBTResults();
      initializeSubjectSelector();
      updateAllGraphs();
      updateAverageScores();
      
      setInterval(saveAllData, 30000);
      setInterval(updateGreeting, 60000);
    }
    
    // ========== TRANSLATION FUNCTION ==========
    function t(key) {
      return CONFIG.translations[currentLanguage][key] || key;
    }
    
    // ========== UI FUNCTIONS ==========
    function updateGreeting() {
      const studentName = localStorage.getItem(STORAGE_KEYS.STUDENT_NAME) || "";
      const hour = new Date().getHours();
      let greeting = '';
      
      if (hour < 12) {
        greeting = currentLanguage === 'hi' ? 'शुभ प्रभात' : 'Good Morning';
      } else if (hour < 18) {
        greeting = currentLanguage === 'hi' ? 'शुभ दोपहर' : 'Good Afternoon';
      } else {
        greeting = currentLanguage === 'hi' ? 'शुभ संध्या' : 'Good Evening';
      }
      
      if (studentName) {
        document.getElementById('greetingText').textContent = `${greeting}, ${studentName}`;
      } else {
        document.getElementById('greetingText').textContent = greeting;
      }
    }
    
    function renderSubjects() {
      const container = document.getElementById('subjectsContainer');
      container.innerHTML = '';
      
      CONFIG.subjects.forEach(subject => {
        const subjectElement = document.createElement('div');
        subjectElement.className = 'subject';
        subjectElement.dataset.subject = subject.id;
        
        const progress = calculateSubjectProgress(subject.id);
        const collapsed = savedUIState[subject.id]?.collapsed || false;
        
        const header = document.createElement('div');
        header.className = 'subject-header';
        
        header.innerHTML = `
          <div class="subject-title">
            <span class="badge ${subject.colorClass}">${subject.title[currentLanguage].split('(')[0].trim()}</span>
          </div>
          <div class="subject-progress-mobile" style="display: none;">
            <div class="progress-wrap">
              <div class="progress-bar">
                <div class="progress-fill" id="bar_${subject.id}" style="width: ${progress}%"></div>
              </div>
              <div class="percent" id="percent_${subject.id}">${Math.round(progress)}%</div>
              <button class="toggle-btn" data-toggle="${subject.id}">
                ${collapsed ? '<i class="fas fa-chevron-right"></i>' : '<i class="fas fa-chevron-down"></i>'}
                ${collapsed ? 'Expand' : 'Collapse'}
              </button>
            </div>
          </div>
        `;
        
        const topicsContainer = document.createElement('div');
        topicsContainer.className = 'topics';
        topicsContainer.id = `topics_${subject.id}`;
        topicsContainer.style.display = collapsed ? 'none' : '';
        
        subject.topics.forEach(topic => {
          const topicId = `${subject.id}_${topic.id}`;
          const isChecked = savedProgress[topicId] || false;
          
          const topicElement = document.createElement('div');
          topicElement.className = 'topic';
          
          let starClass = '';
          if (topic.stars === 3) starClass = 'three-stars';
          else if (topic.stars === 2) starClass = 'two-stars';
          else if (topic.stars === 1) starClass = 'one-star';
          
          // FIXED: English topics always show English names
          const topicName = subject.id === 'english' ? topic.name['en'] : topic.name[currentLanguage];
          const topicHint = subject.id === 'english' ? topic.hint['en'] : topic.hint[currentLanguage];
          
          topicElement.innerHTML = `
            <input type="checkbox" id="${topicId}" ${isChecked ? 'checked' : ''}>
            <label for="${topicId}">
              <strong>${topicName}<span class="stars ${starClass}"></span></strong>
              <small>${topicHint}</small>
            </label>
            <span class="weight">wt ${topic.weight}</span>
          `;
          
          topicsContainer.appendChild(topicElement);
        });
        
        subjectElement.appendChild(header);
        subjectElement.appendChild(topicsContainer);
        container.appendChild(subjectElement);
        
        const progressMobileEl = header.querySelector('.subject-progress-mobile');
        header.addEventListener('click', (e) => {
          if (e.target.closest('.toggle-btn')) return;
          
          const subjectId = subjectElement.dataset.subject;
          const topicsEl = document.getElementById(`topics_${subjectId}`);
          const collapsed = topicsEl.style.display === 'none';
          
          topicsEl.style.display = collapsed ? '' : 'none';
          const btn = header.querySelector(`.toggle-btn[data-toggle="${subjectId}"]`);
          if (btn) {
            btn.innerHTML = collapsed ? 
              '<i class="fas fa-chevron-down"></i> Collapse' : 
              '<i class="fas fa-chevron-right"></i> Expand';
          }
          
          savedUIState[subjectId] = { collapsed: !collapsed };
          saveUIState();
        });
      });
      
      setTimeout(() => {
        document.querySelectorAll('.subject-progress-mobile').forEach(el => {
          el.style.display = 'flex';
        });
      }, 100);
      
      // FIXED: Event delegation for checkbox changes
      document.getElementById('subjectsContainer').addEventListener('change', function(e) {
        if (e.target && e.target.type === 'checkbox') {
          const checkbox = e.target;
          const topicId = checkbox.id;
          savedProgress[topicId] = checkbox.checked;
          saveProgress();
          
          updateProgress();
          
          if (checkbox.checked) {
            showCongratulations(checkbox);
            
            const [subjectId, topicKey] = topicId.split('_');
            const subjectProgress = calculateSubjectProgress(subjectId);
            if (subjectProgress === 100) {
              showSubjectCongratulations(subjectId);
            }
            
            logStudyActivity(topicId);
          }
        }
      });
      
      document.querySelectorAll('.toggle-btn').forEach(button => {
        button.addEventListener('click', function(e) {
          e.stopPropagation();
          const subjectId = this.dataset.toggle;
          const topicsEl = document.getElementById(`topics_${subjectId}`);
          const collapsed = topicsEl.style.display === 'none';
          
          topicsEl.style.display = collapsed ? '' : 'none';
          this.innerHTML = collapsed ? 
            '<i class="fas fa-chevron-down"></i> Collapse' : 
            '<i class="fas fa-chevron-right"></i> Expand';
          
          savedUIState[subjectId] = { collapsed: !collapsed };
          saveUIState();
        });
      });
    }
    
    function calculateSubjectProgress(subjectId) {
      const subject = CONFIG.subjects.find(s => s.id === subjectId);
      if (!subject) return 0;
      
      let totalWeight = 0;
      let completedWeight = 0;
      
      subject.topics.forEach(topic => {
        const topicId = `${subject.id}_${topic.id}`;
        totalWeight += topic.weight;
        if (savedProgress[topicId]) {
          completedWeight += topic.weight;
        }
      });
      
      return totalWeight > 0 ? (completedWeight / totalWeight) * 100 : 0;
    }
    
    function calculateOverallProgress() {
      let totalWeight = 0;
      let completedWeight = 0;
      
      CONFIG.subjects.forEach(subject => {
        subject.topics.forEach(topic => {
          const topicId = `${subject.id}_${topic.id}`;
          totalWeight += topic.weight;
          if (savedProgress[topicId]) {
            completedWeight += topic.weight;
          }
        });
      });
      
      return totalWeight > 0 ? (completedWeight / totalWeight) * 100 : 0;
    }
    
    function updateProgress() {
      const overallProgress = calculateOverallProgress();
      document.getElementById('totalProgress').textContent = `(${Math.round(overallProgress)}% Complete)`;
      
      const donut = document.getElementById('donutOverall');
      const circumference = 2 * Math.PI * 85;
      const offset = circumference * (1 - overallProgress / 100);
      donut.setAttribute('stroke-dasharray', circumference);
      donut.setAttribute('stroke-dashoffset', offset);
      document.getElementById('overallText').textContent = `${Math.round(overallProgress)}%`;
      
      CONFIG.subjects.forEach(subject => {
        const progress = calculateSubjectProgress(subject.id);
        const progressBar = document.getElementById(`bar_${subject.id}`);
        const percentText = document.getElementById(`percent_${subject.id}`);
        
        if (progressBar) progressBar.style.width = `${progress}%`;
        if (percentText) percentText.textContent = `${Math.round(progress)}%`;
      });
      
      if (selectedSubjectForGraph) {
        updateSubjectDonutChart(selectedSubjectForGraph);
      }
    }
    
    function updateSubjectDonutChart(subjectId) {
      const subject = CONFIG.subjects.find(s => s.id === subjectId);
      if (!subject) return;
      
      const progress = calculateSubjectProgress(subjectId);
      const donut = document.getElementById('subjectDonut');
      const circumference = 2 * Math.PI * 85;
      const offset = circumference * (1 - progress / 100);
      
      donut.setAttribute('stroke-dasharray', circumference);
      donut.setAttribute('stroke-dashoffset', offset);
      document.getElementById('subjectChartPercentage').textContent = `${Math.round(progress)}%`;
    }
    
    function showCongratulations(checkbox) {
      const topicId = checkbox.id;
      const [subjectId, topicKey] = topicId.split('_');
      
      const subject = CONFIG.subjects.find(s => s.id === subjectId);
      if (!subject) return;
      
      const topic = subject.topics.find(t => t.id === topicKey);
      if (!topic) return;
      
      // FIXED: Use current language properly for all subjects
      let topicName;
      if (subject.id === 'english') {
        topicName = topic.name['en']; // English subjects always show English names
      } else {
        topicName = topic.name[currentLanguage] || topic.name['en'];
      }
      
      const messages = currentLanguage === 'hi' ? [
        `बधाई हो! आपने "${topicName}" पूरा कर लिया!`,
        `शानदार! "${topicName}" अब पूरा हो गया है!`,
        `अद्भुत! आपने सफलतापूर्वक "${topicName}" पूरा कर लिया!`,
        `वाह! "${topicName}" पूरा करने पर बधाई!`
      ] : [
        `Congratulations! You completed "${topicName}"!`,
        `Awesome! "${topicName}" is now complete!`,
        `Amazing! You successfully completed "${topicName}"!`,
        `Wow! Congratulations on completing "${topicName}"!`
      ];
      
      const randomMessage = messages[Math.floor(Math.random() * messages.length)];
      document.getElementById('congratsMessage').textContent = randomMessage;
      
      document.getElementById('congratsModal').classList.add('active');
      launchConfetti();
    }
    
    function showSubjectCongratulations(subjectId) {
      const subject = CONFIG.subjects.find(s => s.id === subjectId);
      if (!subject) return;
      
      // FIXED: English subject title always shows English
      const subjectTitle = subject.id === 'english' ? subject.title['en'] : subject.title[currentLanguage];
      
      const messages = currentLanguage === 'hi' ? [
        `अद्भुत उपलब्धि! आपने पूरा "${subjectTitle}" विषय पूरा कर लिया!`,
        `शानदार! आपने "${subjectTitle}" विषय में 100% प्रगति हासिल कर ली!`,
        `बधाई हो! आपने "${subjectTitle}" विषय पूरी तरह से मास्टर कर लिया!`,
        `वाह! "${subjectTitle}" विषय पूरा करने पर हार्दिक बधाई!`
      ] : [
        `Amazing Achievement! You completed the entire "${subjectTitle}" subject!`,
        `Outstanding! You achieved 100% progress in "${subjectTitle}"!`,
        `Congratulations! You've completely mastered the "${subjectTitle}" subject!`,
        `Wow! Hearty congratulations on completing the "${subjectTitle}" subject!`
      ];
      
      const randomMessage = messages[Math.floor(Math.random() * messages.length)];
      document.getElementById('subjectCongratsTitle').textContent = t('subjectCongrats');
      document.getElementById('subjectCongratsMessage').textContent = randomMessage;
      
      document.getElementById('subjectCongratsModal').classList.add('active');
      launchBigConfetti();
    }
    
    function showTestCongratsModal() {
      document.getElementById('testCongratsModal').classList.add('active');
      launchConfetti();
    }
    
    function launchConfetti() {
      if (typeof confetti !== 'function') {
        console.error('Confetti library not loaded');
        return;
      }
      
      confetti({
        particleCount: 150,
        spread: 70,
        origin: { y: 0.6 },
        colors: ['#3b82f6', '#10b981', '#8b5cf6', '#f59e0b', '#ef4444']
      });
      
      setTimeout(() => {
        confetti({
          particleCount: 100,
          angle: 60,
          spread: 55,
          origin: { x: 0 },
          colors: ['#8b5cf6', '#f59e0b']
        });
      }, 250);
      
      setTimeout(() => {
        confetti({
          particleCount: 100,
          angle: 120,
          spread: 55,
          origin: { x: 1 },
          colors: ['#3b82f6', '#10b981', '#ef4444']
        });
      }, 500);
    }
    
    function launchBigConfetti() {
      if (typeof confetti !== 'function') {
        console.error('Confetti library not loaded');
        return;
      }
      
      for(let i = 0; i < 5; i++) {
        setTimeout(() => {
          confetti({
            particleCount: 300,
            spread: 100,
            origin: { y: 0.6 },
            colors: ['#3b82f6', '#10b981', '#8b5cf6', '#f59e0b', '#ef4444', '#60a5fa', '#a78bfa']
          });
        }, i * 300);
      }
      
      setTimeout(() => {
        confetti({
          particleCount: 200,
          angle: 60,
          spread: 80,
          origin: { x: 0 },
          colors: ['#8b5cf6', '#f59e0b', '#f97316']
        });
      }, 600);
      
      setTimeout(() => {
        confetti({
          particleCount: 200,
          angle: 120,
          spread: 80,
          origin: { x: 1 },
          colors: ['#3b82f6', '#10b981', '#ef4444', '#06b6d4']
        });
      }, 900);
    }
    
    // ========== MOCK ANALYSIS FUNCTIONS ==========
    function initializeCBTForm() {
      const today = new Date();
      const formattedDate = today.toISOString().split('T')[0];
      document.getElementById('testDate').value = formattedDate;
      updateCBTForm();
      
      // Mark required fields
      document.querySelectorAll('#fullTestFields input[required]').forEach(input => {
        input.addEventListener('input', function() {
          this.classList.remove('error');
          const errorId = this.id + 'Error';
          const errorElement = document.getElementById(errorId);
          if (errorElement) {
            errorElement.classList.remove('show');
          }
        });
      });
      
      document.getElementById('quantitativeMarks').addEventListener('input', updateTotalMarks);
      document.getElementById('englishMarks').addEventListener('input', updateTotalMarks);
      document.getElementById('reasoningMarks').addEventListener('input', updateTotalMarks);
      document.getElementById('awarenessMarks').addEventListener('input', updateTotalMarks);
    }
    
    function updateCBTForm() {
      const config = CONFIG.cbtConfig[currentCBT];
      
      const titles = {
        'full': 'Full Test',
        'quantitative': 'Quantitative Aptitude',
        'english': 'English Language',
        'reasoning': 'Reasoning',
        'awareness': 'General Awareness'
      };
      document.getElementById('testFormTitle').innerHTML = `<i class="fas fa-edit"></i> ${titles[currentTestType]} Marks Entry`;
      
      // Clear any existing errors
      document.querySelectorAll('.error-message').forEach(el => {
        el.classList.remove('show');
      });
      document.querySelectorAll('.error').forEach(el => {
        el.classList.remove('error');
      });
      
      if (currentTestType === 'full') {
        document.getElementById('fullTestFields').style.display = 'block';
        document.getElementById('sectionalTestFields').style.display = 'none';
        
        document.getElementById('quantitativeMarks').max = config.sections.quantitative.maxMarks;
        document.getElementById('quantitativeMarks').placeholder = `Max: ${config.sections.quantitative.maxMarks}`;
        document.getElementById('englishMarks').max = config.sections.english.maxMarks;
        document.getElementById('englishMarks').placeholder = `Max: ${config.sections.english.maxMarks}`;
        document.getElementById('reasoningMarks').max = config.sections.reasoning.maxMarks;
        document.getElementById('reasoningMarks').placeholder = `Max: ${config.sections.reasoning.maxMarks}`;
        document.getElementById('awarenessMarks').max = config.sections.awareness.maxMarks;
        document.getElementById('awarenessMarks').placeholder = `Max: ${config.sections.awareness.maxMarks}`;
        document.getElementById('totalMarks').placeholder = `Max: ${config.totalMarks}`;
        
        // Set required attribute for full test fields
        document.getElementById('quantitativeMarks').required = true;
        document.getElementById('englishMarks').required = true;
        document.getElementById('reasoningMarks').required = true;
        document.getElementById('awarenessMarks').required = true;
        document.getElementById('accuracy').required = true;
        document.getElementById('sectionalMarks').required = false;
      } else {
        document.getElementById('fullTestFields').style.display = 'none';
        document.getElementById('sectionalTestFields').style.display = 'block';
        
        const maxMarks = config.sections[currentTestType].maxMarks;
        document.getElementById('sectionalMarksLabel').textContent = `Marks (Max: ${maxMarks}):`;
        document.getElementById('sectionalMarks').max = maxMarks;
        document.getElementById('sectionalMarks').placeholder = `Max: ${maxMarks}`;
        
        // Set required attribute for sectional test field
        document.getElementById('sectionalMarks').required = true;
        document.getElementById('quantitativeMarks').required = false;
        document.getElementById('englishMarks').required = false;
        document.getElementById('reasoningMarks').required = false;
        document.getElementById('awarenessMarks').required = false;
        document.getElementById('accuracy').required = false;
      }
      
      updateTotalMarks();
    }
    
    function updateTotalMarks() {
      if (currentTestType === 'full') {
        const quantitative = parseFloat(document.getElementById('quantitativeMarks').value) || 0;
        const english = parseFloat(document.getElementById('englishMarks').value) || 0;
        const reasoning = parseFloat(document.getElementById('reasoningMarks').value) || 0;
        const awareness = parseFloat(document.getElementById('awarenessMarks').value) || 0;
        const total = quantitative + english + reasoning + awareness;
        document.getElementById('totalMarks').value = total.toFixed(1);
      }
    }
    
    function validateForm() {
      let isValid = true;
      
      // Clear previous errors
      document.querySelectorAll('.error-message').forEach(el => {
        el.classList.remove('show');
      });
      document.querySelectorAll('.error').forEach(el => {
        el.classList.remove('error');
      });
      
      // Validate test name
      const testName = document.getElementById('testName').value.trim();
      if (!testName) {
        document.getElementById('testName').classList.add('error');
        document.getElementById('testNameError').classList.add('show');
        isValid = false;
      }
      
      // Validate date
      const testDate = document.getElementById('testDate').value;
      if (!testDate) {
        document.getElementById('testDate').classList.add('error');
        document.getElementById('testDateError').classList.add('show');
        isValid = false;
      }
      
      if (currentTestType === 'full') {
        const config = CONFIG.cbtConfig[currentCBT];
        
        // Validate quantitative marks
        const quantitative = document.getElementById('quantitativeMarks').value;
        if (!quantitative || quantitative === '' || parseFloat(quantitative) < 0 || parseFloat(quantitative) > config.sections.quantitative.maxMarks) {
          document.getElementById('quantitativeMarks').classList.add('error');
          document.getElementById('quantitativeError').classList.add('show');
          isValid = false;
        }
        
        // Validate english marks
        const english = document.getElementById('englishMarks').value;
        if (!english || english === '' || parseFloat(english) < 0 || parseFloat(english) > config.sections.english.maxMarks) {
          document.getElementById('englishMarks').classList.add('error');
          document.getElementById('englishError').classList.add('show');
          isValid = false;
        }
        
        // Validate reasoning marks
        const reasoning = document.getElementById('reasoningMarks').value;
        if (!reasoning || reasoning === '' || parseFloat(reasoning) < 0 || parseFloat(reasoning) > config.sections.reasoning.maxMarks) {
          document.getElementById('reasoningMarks').classList.add('error');
          document.getElementById('reasoningError').classList.add('show');
          isValid = false;
        }
        
        // Validate awareness marks
        const awareness = document.getElementById('awarenessMarks').value;
        if (!awareness || awareness === '' || parseFloat(awareness) < 0 || parseFloat(awareness) > config.sections.awareness.maxMarks) {
          document.getElementById('awarenessMarks').classList.add('error');
          document.getElementById('awarenessError').classList.add('show');
          isValid = false;
        }
        
        // Validate accuracy
        const accuracy = document.getElementById('accuracy').value;
        if (!accuracy || accuracy === '' || parseFloat(accuracy) < 0 || parseFloat(accuracy) > 100) {
          document.getElementById('accuracy').classList.add('error');
          document.getElementById('accuracyError').classList.add('show');
          isValid = false;
        }
      } else {
        // Validate sectional marks
        const config = CONFIG.cbtConfig[currentCBT];
        const maxMarks = config.sections[currentTestType].maxMarks;
        const sectionalMarks = document.getElementById('sectionalMarks').value;
        
        if (!sectionalMarks || sectionalMarks === '' || parseFloat(sectionalMarks) < 0 || parseFloat(sectionalMarks) > maxMarks) {
          document.getElementById('sectionalMarks').classList.add('error');
          document.getElementById('sectionalMarksError').classList.add('show');
          isValid = false;
        }
      }
      
      return isValid;
    }
    
    function loadCBTResults() {
      updateLatestPerformance();
    }
    
    function updateLatestPerformance() {
      const latestPerformance = document.getElementById('latestPerformance');
      const selectedTier = latestPerformanceSelection.tier;
      const selectedType = latestPerformanceSelection.type;
      
      if (cbtResults.length === 0) {
        latestPerformance.innerHTML = `
          <div class="no-data-container">
            <div class="no-data-image">
              <img src="https://image2url.com/images/1765986538625-dc51de7a-19d5-4f09-9c44-b96d1a48e991.gif" alt="No Data Available">
            </div>
            <p style="color: var(--muted); margin: 10px 0;">${t('noData')}</p>
          </div>`;
        return;
      }
      
      // Filter results based on selection
      let filteredResults = [...cbtResults];
      
      if (selectedTier !== 'any') {
        filteredResults = filteredResults.filter(r => r.cbt === selectedTier);
      }
      
      if (selectedType !== 'any') {
        if (selectedType === 'full') {
          filteredResults = filteredResults.filter(r => r.testType === 'full');
        } else {
          filteredResults = filteredResults.filter(r => r.testType === 'sectional' && r.section === selectedType);
        }
      }
      
      if (filteredResults.length === 0) {
        latestPerformance.innerHTML = `
          <div class="no-data-container">
            <div class="no-data-image">
              <img src="https://image2url.com/images/1765986538625-dc51de7a-19d5-4f09-9c44-b96d1a48e991.gif" alt="No Data Available">
            </div>
            <p style="color: var(--muted); margin: 10px 0;">No test data found for selected criteria.</p>
          </div>`;
        return;
      }
      
      // Sort by timestamp and get the latest
      filteredResults.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      const latest = filteredResults[0];
      
      let html = '';
      if (latest.testType === 'full') {
        const config = CONFIG.cbtConfig[latest.cbt];
        const percentage = ((latest.total / config.totalMarks) * 100).toFixed(1);
        const date = new Date(latest.date).toLocaleDateString();
        const time = latest.time || '';
        
        html = `
          <div style="text-align: center;">
            <h3 style="color: var(--accent); margin-bottom: 15px;">${latest.name}</h3>
            <div style="font-size: 2.5rem; font-weight: 800; color: var(--accent); margin: 15px 0;">${percentage}%</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
              <div style="background: rgba(59, 130, 246, 0.1); padding: 15px; border-radius: 12px;">
                <div style="font-size: 0.9rem; color: var(--muted);">Quantitative</div>
                <div style="font-size: 1.5rem; font-weight: 800;">${latest.quantitative}/${config.sections.quantitative.maxMarks}</div>
              </div>
              <div style="background: rgba(139, 92, 246, 0.1); padding: 15px; border-radius: 12px;">
                <div style="font-size: 0.9rem; color: var(--muted);">English</div>
                <div style="font-size: 1.5rem; font-weight: 800;">${latest.english}/${config.sections.english.maxMarks}</div>
              </div>
              <div style="background: rgba(16, 185, 129, 0.1); padding: 15px; border-radius: 12px;">
                <div style="font-size: 0.9rem; color: var(--muted);">Reasoning</div>
                <div style="font-size: 1.5rem; font-weight: 800;">${latest.reasoning}/${config.sections.reasoning.maxMarks}</div>
              </div>
              <div style="background: rgba(245, 158, 11, 0.1); padding: 15px; border-radius: 12px;">
                <div style="font-size: 0.9rem; color: var(--muted);">General Awareness</div>
                <div style="font-size: 1.5rem; font-weight: 800;">${latest.awareness}/${config.sections.awareness.maxMarks}</div>
              </div>
            </div>
            <div style="color: var(--muted); font-size: 0.9rem; margin: 10px 0;">Date: ${date} ${time ? `(${time})` : ''}</div>
            <div style="color: var(--accent); font-size: 0.9rem; margin: 10px 0; font-weight: 600;">${latest.cbt === 'tier1' ? 'Tier 1' : 'Tier 2'} • Full Test</div>
            <div style="color: var(--accent-3); font-size: 0.9rem; margin: 10px 0; font-weight: 600;">Accuracy: ${latest.accuracy}%</div>
          </div>
        `;
      } else {
        const config = CONFIG.cbtConfig[latest.cbt];
        const maxMarks = config.sections[latest.section].maxMarks;
        const percentage = ((latest.marks / maxMarks) * 100).toFixed(1);
        const date = new Date(latest.date).toLocaleDateString();
        const time = latest.time || '';
        const sectionNames = {
          'quantitative': 'Quantitative Aptitude',
          'english': 'English Language',
          'reasoning': 'Reasoning',
          'awareness': 'General Awareness'
        };
        
        html = `
          <div style="text-align: center;">
            <h3 style="color: var(--accent); margin-bottom: 15px;">${latest.name}</h3>
            <div style="font-size: 2.5rem; font-weight: 800; color: var(--accent); margin: 15px 0;">${percentage}%</div>
            <div style="background: rgba(59, 130, 246, 0.1); padding: 30px; border-radius: 16px; margin: 20px 0;">
              <div style="font-size: 1.2rem; color: var(--muted); margin-bottom: 10px;">${sectionNames[latest.section]}</div>
              <div style="font-size: 3rem; font-weight: 800; color: var(--accent);">${latest.marks}/${maxMarks}</div>
            </div>
            <div style="color: var(--muted); font-size: 0.9rem; margin: 10px 0;">Date: ${date} ${time ? `(${time})` : ''}</div>
            <div style="color: var(--accent); font-size: 0.9rem; margin: 10px 0; font-weight: 600;">${latest.cbt === 'tier1' ? 'Tier 1' : 'Tier 2'} • Sectional Test</div>
          </div>
        `;
      }
      
      latestPerformance.innerHTML = html;
    }
    
    function updateAllGraphs() {
      updateFullTestGraph();
      updateSubjectGraph();
      updateAccuracyGraph();
    }
    
    function updateFullTestGraph() {
      const ctx = document.getElementById('fullTestChart').getContext('2d');
      
      if (charts.fullTest) {
        charts.fullTest.destroy();
      }
      
      let filteredResults = cbtResults.filter(r => r.cbt === currentGraphCBT && r.testType === 'full');
      
      if (filteredResults.length === 0) {
        document.getElementById('fullTestGraphContainer').style.display = 'none';
        document.getElementById('fullTestNoData').style.display = 'block';
        return;
      }
      
      document.getElementById('fullTestGraphContainer').style.display = 'block';
      document.getElementById('fullTestNoData').style.display = 'none';
      
      filteredResults.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
      
      const labels = filteredResults.map(r => {
        const date = new Date(r.date);
        return date.toLocaleDateString('en-US', { 
          month: 'short', 
          day: 'numeric' 
        });
      });
      
      const pointRadius = filteredResults.length === 1 ? 8 : 6;
      
      let datasets = [];
      
      if (fullTestGraphView === 'total') {
        const scores = filteredResults.map(r => r.total);
        const percentages = filteredResults.map(r => r.accuracy || 0);
        
        datasets = [
          {
            label: 'Total Marks',
            data: scores,
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            tension: 0.3,
            fill: true,
            pointRadius: pointRadius,
            pointBackgroundColor: '#3b82f6',
            yAxisID: 'y'
          },
          {
            label: 'Accuracy',
            data: percentages,
            borderColor: '#8b5cf6',
            backgroundColor: 'rgba(139, 92, 246, 0.1)',
            tension: 0.3,
            fill: false,
            pointRadius: pointRadius,
            pointBackgroundColor: '#8b5cf6',
            yAxisID: 'y1'
          }
        ];
        
        document.getElementById('fullTestGraphInfo').textContent = 'Shows full test scores and accuracy';
      } else {
        const subjectData = filteredResults.map(r => {
          if (fullTestGraphView === 'quantitative') return r.quantitative;
          if (fullTestGraphView === 'english') return r.english;
          if (fullTestGraphView === 'reasoning') return r.reasoning;
          if (fullTestGraphView === 'awareness') return r.awareness;
          return 0;
        });
        
        const colors = {
          'quantitative': '#3b82f6',
          'english': '#8b5cf6',
          'reasoning': '#10b981',
          'awareness': '#f59e0b'
        };
        
        const labelsText = {
          'quantitative': 'Quantitative Aptitude',
          'english': 'English Language',
          'reasoning': 'Reasoning',
          'awareness': 'General Awareness'
        };
        
        datasets = [
          {
            label: labelsText[fullTestGraphView],
            data: subjectData,
            borderColor: colors[fullTestGraphView],
            backgroundColor: colors[fullTestGraphView] + '40',
            tension: 0.3,
            fill: true,
            pointRadius: pointRadius,
            pointBackgroundColor: colors[fullTestGraphView],
            yAxisID: 'y'
          }
        ];
        
        document.getElementById('fullTestGraphInfo').textContent = `Shows ${labelsText[fullTestGraphView]} marks from full tests`;
      }
      
      charts.fullTest = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          stacked: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: 'var(--text)',
                font: {
                  size: 12
                }
              }
            },
            title: {
              display: true,
              text: `${currentGraphCBT === 'tier1' ? 'Tier 1' : 'Tier 2'} - Full Test Performance (${fullTestGraphView === 'total' ? 'Total Marks' : fullTestGraphView.charAt(0).toUpperCase() + fullTestGraphView.slice(1)})`,
              color: 'var(--text)',
              font: {
                size: 16,
                weight: 'bold'
              }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  let label = context.dataset.label || '';
                  if (label) {
                    label += ': ';
                  }
                  if (context.parsed.y !== null) {
                    if (fullTestGraphView === 'total' && context.datasetIndex === 0) {
                      label += context.parsed.y + ' marks';
                    } else if (fullTestGraphView === 'total' && context.datasetIndex === 1) {
                      label += context.parsed.y + '%';
                    } else {
                      label += context.parsed.y + ' marks';
                    }
                  }
                  return label;
                }
              }
            }
          },
          scales: {
            x: {
              ticks: {
                color: 'var(--text)',
                maxRotation: 45,
                font: {
                  size: 11
                }
              },
              grid: {
                color: 'var(--border)'
              }
            },
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: fullTestGraphView === 'total' ? 'Total Marks' : 'Marks',
                color: 'var(--text)'
              },
              ticks: {
                color: 'var(--text)'
              },
              grid: {
                color: 'var(--border)'
              }
            },
            y1: {
              type: 'linear',
              display: fullTestGraphView === 'total',
              position: 'right',
              title: {
                display: true,
                text: 'Accuracy (%)',
                color: 'var(--text)'
              },
              ticks: {
                color: 'var(--text)'
              },
              grid: {
                drawOnChartArea: false,
              },
            }
          }
        }
      });
    }
    
    function updateSubjectGraph() {
      const ctx = document.getElementById('subjectChart').getContext('2d');
      
      if (charts.subject) {
        charts.subject.destroy();
      }
      
      let filteredResults = cbtResults.filter(r => r.cbt === currentGraphCBT && 
        r.testType === 'sectional' && r.section === selectedSubjectForChart);
      
      if (filteredResults.length === 0) {
        document.getElementById('subjectGraphContainer').style.display = 'none';
        document.getElementById('subjectNoData').style.display = 'block';
        return;
      }
      
      document.getElementById('subjectGraphContainer').style.display = 'block';
      document.getElementById('subjectNoData').style.display = 'none';
      
      filteredResults.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
      
      const subjectData = filteredResults.map(r => r.marks);
      const labels = filteredResults.map(r => {
        const date = new Date(r.date);
        return date.toLocaleDateString('en-US', { 
          month: 'short', 
          day: 'numeric' 
        });
      });
      
      const pointRadius = filteredResults.length === 1 ? 8 : 6;
      
      const subjectNames = {
        'quantitative': 'Quantitative Aptitude',
        'english': 'English Language',
        'reasoning': 'Reasoning',
        'awareness': 'General Awareness'
      };
      
      const colors = {
        'quantitative': '#3b82f6',
        'english': '#8b5cf6',
        'reasoning': '#10b981',
        'awareness': '#f59e0b'
      };
      
      charts.subject = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: subjectNames[selectedSubjectForChart] + ' (Sectional)',
              data: subjectData,
              backgroundColor: colors[selectedSubjectForChart] + '40',
              borderColor: colors[selectedSubjectForChart],
              borderWidth: 2,
              fill: true,
              tension: 0.3,
              pointRadius: pointRadius
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: 'var(--text)',
                font: {
                  size: 12
                }
              }
            },
            title: {
              display: true,
              text: `${currentGraphCBT === 'tier1' ? 'Tier 1' : 'Tier 2'} - ${subjectNames[selectedSubjectForChart]} Performance (Sectional Tests Only)`,
              color: 'var(--text)',
              font: {
                size: 16,
                weight: 'bold'
              }
            }
          },
          scales: {
            x: {
              ticks: {
                color: 'var(--text)',
                maxRotation: 45,
                font: {
                  size: 11
                }
              },
              grid: {
                color: 'var(--border)'
              }
            },
            y: {
              beginAtZero: true,
              ticks: {
                color: 'var(--text)'
              },
              grid: {
                color: 'var(--border)'
              },
              title: {
                display: true,
                text: 'Marks',
                color: 'var(--text)'
              }
            }
          }
        }
      });
    }
    
    function updateAccuracyGraph() {
      const ctx = document.getElementById('accuracyChart').getContext('2d');
      
      if (charts.accuracy) {
        charts.accuracy.destroy();
      }
      
      let filteredResults = cbtResults.filter(r => r.cbt === currentGraphCBT && r.testType === 'full');
      
      if (filteredResults.length === 0) {
        document.getElementById('accuracyGraphContainer').style.display = 'none';
        document.getElementById('accuracyNoData').style.display = 'block';
        return;
      }
      
      document.getElementById('accuracyGraphContainer').style.display = 'block';
      document.getElementById('accuracyNoData').style.display = 'none';
      
      filteredResults.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
      
      const labels = filteredResults.map(r => {
        const date = new Date(r.date);
        return date.toLocaleDateString('en-US', { 
          month: 'short', 
          day: 'numeric' 
        });
      });
      
      const accuracyData = filteredResults.map(r => r.accuracy || 0);
      const pointRadius = filteredResults.length === 1 ? 8 : 6;
      
      charts.accuracy = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'Accuracy',
              data: accuracyData,
              borderColor: '#8b5cf6',
              backgroundColor: 'rgba(139, 92, 246, 0.1)',
              tension: 0.3,
              fill: true,
              pointRadius: pointRadius,
              pointBackgroundColor: '#8b5cf6'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: 'var(--text)',
                font: {
                  size: 12
                }
              }
            },
            title: {
              display: true,
              text: `${currentGraphCBT === 'tier1' ? 'Tier 1' : 'Tier 2'} - Accuracy Analysis`,
              color: 'var(--text)',
              font: {
                size: 16,
                weight: 'bold'
              }
            }
          },
          scales: {
            x: {
              ticks: {
                color: 'var(--text)',
                maxRotation: 45,
                font: {
                  size: 11
                }
              },
              grid: {
                color: 'var(--border)'
              }
            },
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                color: 'var(--text)',
                callback: function(value) {
                  return value + '%';
                }
              },
              grid: {
                color: 'var(--border)'
              },
              title: {
                display: true,
                text: 'Accuracy (%)',
                color: 'var(--text)'
              }
            }
          }
        }
      });
    }
    
    function updateAverageScores() {
      const container = document.getElementById('avgScoreContainer');
      
      if (cbtResults.length === 0) {
        container.innerHTML = `
          <div class="no-data-container" style="width: 100%;">
            <p style="color: var(--muted); margin: 10px 0;">${t('noData')}</p>
          </div>`;
        return;
      }
      
      let tier1FullTests = cbtResults.filter(r => r.cbt === 'tier1' && r.testType === 'full');
      let tier2FullTests = cbtResults.filter(r => r.cbt === 'tier2' && r.testType === 'full');
      
      let tier1QuantitativeTests = cbtResults.filter(r => r.cbt === 'tier1' && r.testType === 'sectional' && r.section === 'quantitative');
      let tier2QuantitativeTests = cbtResults.filter(r => r.cbt === 'tier2' && r.testType === 'sectional' && r.section === 'quantitative');
      
      let tier1EnglishTests = cbtResults.filter(r => r.cbt === 'tier1' && r.testType === 'sectional' && r.section === 'english');
      let tier2EnglishTests = cbtResults.filter(r => r.cbt === 'tier2' && r.testType === 'sectional' && r.section === 'english');
      
      let tier1ReasoningTests = cbtResults.filter(r => r.cbt === 'tier1' && r.testType === 'sectional' && r.section === 'reasoning');
      let tier2ReasoningTests = cbtResults.filter(r => r.cbt === 'tier2' && r.testType === 'sectional' && r.section === 'reasoning');
      
      let tier1AwarenessTests = cbtResults.filter(r => r.cbt === 'tier1' && r.testType === 'sectional' && r.section === 'awareness');
      let tier2AwarenessTests = cbtResults.filter(r => r.cbt === 'tier2' && r.testType === 'sectional' && r.section === 'awareness');
      
      function calculateAverage(tests, type) {
        if (tests.length === 0) return 0;
        
        let total = 0;
        tests.forEach(test => {
          if (type === 'full') {
            total += test.total;
          } else {
            total += test.marks;
          }
        });
        
        return (total / tests.length).toFixed(1);
      }
      
      const tier1FullAvg = calculateAverage(tier1FullTests, 'full');
      const tier2FullAvg = calculateAverage(tier2FullTests, 'full');
      const tier1QuantitativeAvg = calculateAverage(tier1QuantitativeTests, 'quantitative');
      const tier2QuantitativeAvg = calculateAverage(tier2QuantitativeTests, 'quantitative');
      const tier1EnglishAvg = calculateAverage(tier1EnglishTests, 'english');
      const tier2EnglishAvg = calculateAverage(tier2EnglishTests, 'english');
      const tier1ReasoningAvg = calculateAverage(tier1ReasoningTests, 'reasoning');
      const tier2ReasoningAvg = calculateAverage(tier2ReasoningTests, 'reasoning');
      const tier1AwarenessAvg = calculateAverage(tier1AwarenessTests, 'awareness');
      const tier2AwarenessAvg = calculateAverage(tier2AwarenessTests, 'awareness');
      
      container.innerHTML = `
        <div class="avg-score-card">
          <div class="avg-score-label">${t('tier1Avg')}</div>
          <div class="avg-score-value">${tier1FullAvg > 0 ? tier1FullAvg : '--'}</div>
          <div class="avg-score-label">${tier1FullTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">${t('tier2Avg')}</div>
          <div class="avg-score-value">${tier2FullAvg > 0 ? tier2FullAvg : '--'}</div>
          <div class="avg-score-label">${tier2FullTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">Tier 1 Quantitative</div>
          <div class="avg-score-value">${tier1QuantitativeAvg > 0 ? tier1QuantitativeAvg : '--'}</div>
          <div class="avg-score-label">${tier1QuantitativeTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">Tier 2 Quantitative</div>
          <div class="avg-score-value">${tier2QuantitativeAvg > 0 ? tier2QuantitativeAvg : '--'}</div>
          <div class="avg-score-label">${tier2QuantitativeTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">Tier 1 English</div>
          <div class="avg-score-value">${tier1EnglishAvg > 0 ? tier1EnglishAvg : '--'}</div>
          <div class="avg-score-label">${tier1EnglishTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">Tier 2 English</div>
          <div class="avg-score-value">${tier2EnglishAvg > 0 ? tier2EnglishAvg : '--'}</div>
          <div class="avg-score-label">${tier2EnglishTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">Tier 1 Reasoning</div>
          <div class="avg-score-value">${tier1ReasoningAvg > 0 ? tier1ReasoningAvg : '--'}</div>
          <div class="avg-score-label">${tier1ReasoningTests.length} ${t('tests')}</div>
        </div>
        <div class="avg-score-card">
          <div class="avg-score-label">Tier 2 Reasoning</div>
          <div class="avg-score-value">${tier2ReasoningAvg > 0 ? tier2ReasoningAvg : '--'}</div>
          <div class="avg-score-label">${tier2ReasoningTests.length} ${t('tests')}</div>
        </div>
      `;
    }
    
    function showTestHistory() {
      const tableBody = document.getElementById('historyTableBody');
      tableBody.innerHTML = '';
      
      const sortedResults = [...cbtResults].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      if (sortedResults.length === 0) {
        tableBody.innerHTML = `
          <tr>
            <td colspan="9" style="text-align: center; padding: 30px; color: var(--muted);">
              No test data yet. Add your first test entry.
            </td>
          </tr>
        `;
        return;
      }
      
      sortedResults.forEach(test => {
        const row = document.createElement('tr');
        row.className = 'history-item';
        
        const date = new Date(test.date);
        const formattedDate = date.toLocaleDateString();
        const time = test.time || '';
        
        let typeText = '';
        let quantitativeText = '', englishText = '', reasoningText = '', awarenessText = '';
        
        if (test.testType === 'full') {
          typeText = 'Full Test';
          const config = CONFIG.cbtConfig[test.cbt];
          quantitativeText = `${test.quantitative}/${config.sections.quantitative.maxMarks}`;
          englishText = `${test.english}/${config.sections.english.maxMarks}`;
          reasoningText = `${test.reasoning}/${config.sections.reasoning.maxMarks}`;
          awarenessText = `${test.awareness}/${config.sections.awareness.maxMarks}`;
        } else {
          const sectionNames = {
            'quantitative': 'Quantitative Aptitude',
            'english': 'English Language',
            'reasoning': 'Reasoning',
            'awareness': 'General Awareness'
          };
          typeText = sectionNames[test.section] || test.section;
          const config = CONFIG.cbtConfig[test.cbt];
          const maxMarks = config.sections[test.section].maxMarks;
          if (test.section === 'quantitative') quantitativeText = `${test.marks}/${maxMarks}`;
          else if (test.section === 'english') englishText = `${test.marks}/${maxMarks}`;
          else if (test.section === 'reasoning') reasoningText = `${test.marks}/${maxMarks}`;
          else if (test.section === 'awareness') awarenessText = `${test.marks}/${maxMarks}`;
        }
        
        row.innerHTML = `
          <td>${test.name}</td>
          <td>${typeText}</td>
          <td>${test.cbt === 'tier1' ? 'Tier 1' : 'Tier 2'}</td>
          <td>${formattedDate} ${time ? `(${time})` : ''}</td>
          <td><strong>${test.testType === 'full' ? `${test.total}/${CONFIG.cbtConfig[test.cbt].totalMarks}` : ''}</strong></td>
          <td>${quantitativeText}</td>
          <td>${englishText}</td>
          <td>${reasoningText}</td>
          <td>${awarenessText}</td>
        `;
        
        row.addEventListener('click', () => {
          let details = `${test.name}\n`;
          details += `Date: ${formattedDate} ${time ? `(${time})` : ''}\n`;
          details += `Type: ${typeText}\n`;
          details += `Tier: ${test.cbt === 'tier1' ? 'Tier 1' : 'Tier 2'}\n`;
          
          if (test.testType === 'full') {
            const config = CONFIG.cbtConfig[test.cbt];
            details += `\nQuantitative Aptitude: ${test.quantitative}/${config.sections.quantitative.maxMarks}\n`;
            details += `English Language: ${test.english}/${config.sections.english.maxMarks}\n`;
            details += `Reasoning: ${test.reasoning}/${config.sections.reasoning.maxMarks}\n`;
            details += `General Awareness: ${test.awareness}/${config.sections.awareness.maxMarks}\n`;
            details += `Total Marks: ${test.total}/${config.totalMarks}\n`;
            if (test.accuracy) {
              details += `Accuracy: ${test.accuracy}%`;
            }
          } else {
            const config = CONFIG.cbtConfig[test.cbt];
            const maxMarks = config.sections[test.section].maxMarks;
            details += `\nMarks: ${test.marks}/${maxMarks}\n`;
            details += `Percentage: ${((test.marks / maxMarks) * 100).toFixed(1)}%`;
          }
          
          alert(details);
        });
        
        tableBody.appendChild(row);
      });
      
      document.getElementById('historyModal').classList.add('active');
    }
    
    function logStudyActivity(topicId) {
      const today = new Date().toDateString();
      const todayLog = studyLog.find(log => new Date(log.date).toDateString() === today);
      
      if (todayLog) {
        if (!todayLog.topics.includes(topicId)) {
          todayLog.topics.push(topicId);
        }
      } else {
        studyLog.push({
          date: new Date().toISOString(),
          topics: [topicId]
        });
      }
      
      localStorage.setItem(STORAGE_KEYS.STUDY_LOG, JSON.stringify(studyLog));
    }
    
    // ========== SHARE PROGRESS FUNCTION ==========
    async function shareProgress() {
      try {
        const overallProgress = calculateOverallProgress();
        const studentName = localStorage.getItem(STORAGE_KEYS.STUDENT_NAME) || "Student";
        
        // Calculate subject-wise progress
        let subjectProgressText = "";
        CONFIG.subjects.forEach(subject => {
          const progress = calculateSubjectProgress(subject.id);
          const emoji = progress === 100 ? "✅" : progress >= 50 ? "🟡" : "🔴";
          subjectProgressText += `\n${emoji} ${subject.title[currentLanguage].split('(')[0].trim()}: ${Math.round(progress)}%`;
        });
        
        // Calculate average scores
        let tier1FullTests = cbtResults.filter(r => r.cbt === 'tier1' && r.testType === 'full');
        let tier2FullTests = cbtResults.filter(r => r.cbt === 'tier2' && r.testType === 'full');
        
        let tier1FullAvg = tier1FullTests.length > 0 ? 
          (tier1FullTests.reduce((sum, t) => sum + t.total, 0) / tier1FullTests.length).toFixed(1) : 0;
        let tier2FullAvg = tier2FullTests.length > 0 ? 
          (tier2FullTests.reduce((sum, t) => sum + t.total, 0) / tier2FullTests.length).toFixed(1) : 0;
        
        // Build share text with emojis
        const shareText = currentLanguage === 'hi' ? 
          `📊 *मेरी SSC CGL PRO प्रगति रिपोर्ट* 📊\n\n` +
          `👤 *छात्र:* ${studentName}\n` +
          `📅 *तारीख:* ${new Date().toLocaleDateString('hi-IN')}\n\n` +
          `🎯 *समग्र प्रगति:* ${Math.round(overallProgress)}%\n\n` +
          `📚 *विषय-वार प्रगति:*${subjectProgressText}\n\n` +
          `🏆 *औसत स्कोर:*\n` +
          `   • Tier 1: ${tier1FullAvg > 0 ? tier1FullAvg + '/200' : 'अभी तक डेटा नहीं'}\n` +
          `   • Tier 2: ${tier2FullAvg > 0 ? tier2FullAvg + '/390' : 'अभी तक डेटा नहीं'}\n\n` +
          `🚀 *कुल टेस्ट दिए:* ${cbtResults.length}\n` +
          `📈 *पूर्ण टेस्ट:* ${tier1FullTests.length + tier2FullTests.length}\n\n` +
          `🔗 *अपनी तैयारी ट्रैक करें:* https://skpro7.github.io/cgl/\n\n` +
          `#SSC_CGL_PRO #SSC_CGL #ExamPreparation 💪` :
          `📊 *My SSC CGL PRO Progress Report* 📊\n\n` +
          `👤 *Student:* ${studentName}\n` +
          `📅 *Date:* ${new Date().toLocaleDateString('en-US')}\n\n` +
          `🎯 *Overall Progress:* ${Math.round(overallProgress)}%\n\n` +
          `📚 *Subject-wise Progress:*${subjectProgressText}\n\n` +
          `🏆 *Average Scores:*\n` +
          `   • Tier 1: ${tier1FullAvg > 0 ? tier1FullAvg + '/200' : 'No data yet'}\n` +
          `   • Tier 2: ${tier2FullAvg > 0 ? tier2FullAvg + '/390' : 'No data yet'}\n\n` +
          `🚀 *Total Tests Taken:* ${cbtResults.length}\n` +
          `📈 *Full Tests:* ${tier1FullTests.length + tier2FullTests.length}\n\n` +
          `🔗 *Track your preparation:* https://skpro7.github.io/cgl/\n\n` +
          `#SSC_CGL_PRO #SSC_CGL #ExamPreparation 💪`;
        
        if (navigator.share) {
          await navigator.share({
            title: `${studentName}'s SSC CGL Progress Report`,
            text: shareText
          });
        } else {
          await navigator.clipboard.writeText(shareText);
          alert(currentLanguage === 'hi' ? 
            'प्रगति रिपोर्ट क्लिपबोर्ड पर कॉपी किया गया! आप अब इसे साझा कर सकते हैं।' : 
            'Progress report copied to clipboard! You can now share it.');
        }
      } catch (error) {
        console.error('Error sharing progress:', error);
      }
    }
    
    // ========== EVENT LISTENERS SETUP ==========
    function setupEventListeners() {
      // Drawer menu
      document.getElementById('menuBtn').addEventListener('click', () => {
        document.getElementById('drawer').classList.add('active');
        document.getElementById('drawerOverlay').classList.add('active');
      });
      
      document.getElementById('drawerClose').addEventListener('click', closeDrawer);
      document.getElementById('drawerOverlay').addEventListener('click', closeDrawer);
      
      // FIXED: Settings buttons toggle with proper event delegation
      document.getElementById('themeSettingsBtn').addEventListener('click', function() {
        this.classList.toggle('active');
        const content = document.getElementById('themeSettings');
        content.classList.toggle('active');
        const icon = this.querySelector('i.fa-chevron-right');
        if (icon) {
          if (content.classList.contains('active')) {
            icon.classList.remove('fa-chevron-right');
            icon.classList.add('fa-chevron-down');
          } else {
            icon.classList.remove('fa-chevron-down');
            icon.classList.add('fa-chevron-right');
          }
        }
      });
      
      document.getElementById('languageSettingsBtn').addEventListener('click', function() {
        this.classList.toggle('active');
        const content = document.getElementById('languageSettings');
        content.classList.toggle('active');
        const icon = this.querySelector('i.fa-chevron-right');
        if (icon) {
          if (content.classList.contains('active')) {
            icon.classList.remove('fa-chevron-right');
            icon.classList.add('fa-chevron-down');
          } else {
            icon.classList.remove('fa-chevron-down');
            icon.classList.add('fa-chevron-right');
          }
        }
      });
      
      // Language toggle - FIXED: Use event delegation properly
      document.getElementById('languageSettings').addEventListener('click', function(e) {
        if (e.target.classList.contains('lang-btn')) {
          const lang = e.target.dataset.lang;
          setLanguage(lang);
          
          document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
        }
      });
      
      // Theme buttons - FIXED: Use event delegation properly
      document.getElementById('themeSettings').addEventListener('click', function(e) {
        if (e.target.classList.contains('theme-btn')) {
          const theme = e.target.dataset.theme;
          setTheme(theme);
          
          document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
        }
      });
      
      // Bottom Navigation Tabs
      document.querySelectorAll('.nav-tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const tabId = this.dataset.tab;
          
          document.querySelectorAll('.nav-tab-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          
          document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
          });
          document.getElementById(`${tabId}-tab`).classList.add('active');
          
          window.scrollTo(0, 0);
          
          if (tabId === 'mock-analysis') {
            setTimeout(() => {
              updateAllGraphs();
              updateAverageScores();
            }, 100);
          }
        });
      });
      
      // Graph view switch
      document.querySelectorAll('.view-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const view = this.dataset.view;
          
          document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          
          if (view === 'overall') {
            document.getElementById('overallGraphView').style.display = 'block';
            document.getElementById('subjectGraphView').style.display = 'none';
          } else {
            document.getElementById('overallGraphView').style.display = 'none';
            document.getElementById('subjectGraphView').style.display = 'block';
            
            if (!selectedSubjectForGraph) {
              selectedSubjectForGraph = CONFIG.subjects[0].id;
              initializeSubjectSelector();
              updateSubjectDonutChart(selectedSubjectForGraph);
            }
          }
        });
      });
      
      // Tier type buttons
      document.querySelectorAll('.cbt-type-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.cbt-type-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          currentCBT = this.dataset.cbt;
          updateCBTForm();
        });
      });
      
      // Test type buttons
      document.querySelectorAll('.test-type-btn[data-test-type]').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.test-type-btn[data-test-type]').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          currentTestType = this.dataset.testType;
          updateCBTForm();
        });
      });
      
      // Graph CBT Toggles
      document.querySelectorAll('.graph-cbt-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const cbt = this.dataset.cbt;
          
          document.querySelectorAll('.graph-cbt-toggle .graph-cbt-btn').forEach(b => {
            b.classList.remove('active');
            if (b.dataset.cbt === cbt) {
              b.classList.add('active');
            }
          });
          
          currentGraphCBT = cbt;
          updateAllGraphs();
          updateAverageScores();
        });
      });
      
      // Subject graph buttons
      document.querySelectorAll('.performance-subject-btn[data-subject]').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.performance-subject-btn[data-subject]').forEach(b => {
            b.classList.remove('active');
          });
          this.classList.add('active');
          selectedSubjectForChart = this.dataset.subject;
          updateSubjectGraph();
        });
      });
      
      // Full Test Toggle buttons
      document.querySelectorAll('.full-test-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.full-test-btn').forEach(b => {
            b.classList.remove('active');
          });
          this.classList.add('active');
          fullTestGraphView = this.dataset.view;
          updateFullTestGraph();
        });
      });
      
      // Latest Performance Selector
      document.querySelectorAll('.performance-tier-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const tier = this.dataset.tier;
          
          document.querySelectorAll('.performance-tier-btn').forEach(b => {
            b.classList.remove('active');
          });
          this.classList.add('active');
          
          latestPerformanceSelection.tier = tier;
          localStorage.setItem(STORAGE_KEYS.LATEST_PERF_SELECTION, JSON.stringify(latestPerformanceSelection));
          updateLatestPerformance();
        });
      });
      
      document.querySelectorAll('.performance-test-type-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const type = this.dataset.type;
          
          document.querySelectorAll('.performance-test-type-btn').forEach(b => {
            b.classList.remove('active');
          });
          this.classList.add('active');
          
          latestPerformanceSelection.type = type;
          localStorage.setItem(STORAGE_KEYS.LATEST_PERF_SELECTION, JSON.stringify(latestPerformanceSelection));
          updateLatestPerformance();
        });
      });
      
      // FIXED: CBT form submission - prevent multiple submissions
      document.getElementById('cbtForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Prevent multiple submissions
        if (isSubmitting) {
          return;
        }
        
        // Validate form before submission
        if (!validateForm()) {
          alert('Please fill all required fields with valid values!');
          return;
        }
        
        isSubmitting = true;
        const config = CONFIG.cbtConfig[currentCBT];
        let testData;
        
        const now = new Date();
        const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        
        // Disable submit button to prevent double submission
        const submitBtn = document.getElementById('submitTestBtn');
        const loadingSpinner = document.getElementById('formLoading');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
        submitBtn.disabled = true;
        loadingSpinner.style.display = 'block';
        
        // Process submission
        if (currentTestType === 'full') {
          const quantitative = parseFloat(document.getElementById('quantitativeMarks').value) || 0;
          const english = parseFloat(document.getElementById('englishMarks').value) || 0;
          const reasoning = parseFloat(document.getElementById('reasoningMarks').value) || 0;
          const awareness = parseFloat(document.getElementById('awarenessMarks').value) || 0;
          const accuracy = parseFloat(document.getElementById('accuracy').value) || 0;
          const total = quantitative + english + reasoning + awareness;
          
          testData = {
            name: document.getElementById('testName').value.trim(),
            date: document.getElementById('testDate').value,
            time: timeString,
            timestamp: now.toISOString(),
            cbt: currentCBT,
            testType: 'full',
            quantitative: quantitative,
            english: english,
            reasoning: reasoning,
            awareness: awareness,
            total: total,
            accuracy: accuracy
          };
        } else {
          testData = {
            name: document.getElementById('testName').value.trim(),
            date: document.getElementById('testDate').value,
            time: timeString,
            timestamp: now.toISOString(),
            cbt: currentCBT,
            testType: 'sectional',
            section: currentTestType,
            marks: parseFloat(document.getElementById('sectionalMarks').value) || 0
          };
        }
        
        // Add test to results
        cbtResults.push(testData);
        localStorage.setItem(STORAGE_KEYS.CBT_RESULTS, JSON.stringify(cbtResults));
        
        // Reset form
        this.reset();
        const today = new Date();
        const formattedDate = today.toISOString().split('T')[0];
        document.getElementById('testDate').value = formattedDate;
        updateCBTForm();
        
        // Update UI
        loadCBTResults();
        updateAllGraphs();
        updateAverageScores();
        
        // Reset button and hide loading spinner
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        loadingSpinner.style.display = 'none';
        isSubmitting = false;
        
        // Show congratulations modal
        setTimeout(() => {
          showTestCongratsModal();
        }, 300);
      });
      
      // Control buttons
      document.getElementById('expandAll').addEventListener('click', () => {
        CONFIG.subjects.forEach(subject => {
          const topicsEl = document.getElementById(`topics_${subject.id}`);
          topicsEl.style.display = '';
          const btn = document.querySelector(`.toggle-btn[data-toggle="${subject.id}"]`);
          if (btn) btn.innerHTML = '<i class="fas fa-chevron-down"></i> Collapse';
          
          savedUIState[subject.id] = { collapsed: false };
        });
        saveUIState();
      });
      
      document.getElementById('collapseAll').addEventListener('click', () => {
        CONFIG.subjects.forEach(subject => {
          const topicsEl = document.getElementById(`topics_${subject.id}`);
          topicsEl.style.display = 'none';
          const btn = document.querySelector(`.toggle-btn[data-toggle="${subject.id}"]`);
          if (btn) btn.innerHTML = '<i class="fas fa-chevron-right"></i> Expand';
          
          savedUIState[subject.id] = { collapsed: true };
        });
        saveUIState();
      });
      
      // History button
      document.getElementById('showHistoryBtn').addEventListener('click', showTestHistory);
      document.getElementById('closeHistory').addEventListener('click', () => {
        document.getElementById('historyModal').classList.remove('active');
      });
      
      // Reset button
      document.getElementById('resetBtn').addEventListener('click', () => {
        document.getElementById('resetModal').classList.add('active');
      });
      
      document.getElementById('resetCancel').addEventListener('click', () => {
        document.getElementById('resetModal').classList.remove('active');
        document.getElementById('resetConfirmInput').value = '';
        document.getElementById('resetConfirm').disabled = true;
      });
      
      document.getElementById('resetConfirmInput').addEventListener('input', function() {
        document.getElementById('resetConfirm').disabled = 
          this.value !== "RESET MY PROGRESS";
      });
      
      document.getElementById('resetConfirm').addEventListener('click', () => {
        savedProgress = {};
        cbtResults = [];
        studyLog = [];
        
        localStorage.setItem(STORAGE_KEYS.PROGRESS, JSON.stringify(savedProgress));
        localStorage.setItem(STORAGE_KEYS.CBT_RESULTS, JSON.stringify(cbtResults));
        localStorage.setItem(STORAGE_KEYS.STUDY_LOG, JSON.stringify(studyLog));
        
        document.querySelectorAll('.topic input[type="checkbox"]').forEach(checkbox => {
          checkbox.checked = false;
        });
        
        updateProgress();
        loadCBTResults();
        updateAllGraphs();
        updateAverageScores();
        
        document.getElementById('resetModal').classList.remove('active');
        document.getElementById('resetConfirmInput').value = '';
        document.getElementById('resetConfirm').disabled = true;
        
        alert('All data has been reset!');
      });
      
      // Export/Import buttons
      document.getElementById('exportBackupBtn').addEventListener('click', exportBackup);
      document.getElementById('importBackupBtn').addEventListener('click', () => {
        document.getElementById('importFile').click();
      });
      
      document.getElementById('importFile').addEventListener('change', importBackup);
      
      // Share buttons
      document.getElementById('shareProgressBtn').addEventListener('click', shareProgress);
      document.getElementById('shareWebsiteBtn').addEventListener('click', shareWebsite);
      
      // Close congratulations modals
      document.getElementById('closeCongrats').addEventListener('click', () => {
        document.getElementById('congratsModal').classList.remove('active');
      });
      
      document.getElementById('closeSubjectCongrats').addEventListener('click', () => {
        document.getElementById('subjectCongratsModal').classList.remove('active');
      });
      
      document.getElementById('closeTestCongrats').addEventListener('click', () => {
        document.getElementById('testCongratsModal').classList.remove('active');
      });
    }
    
    function closeDrawer() {
      document.getElementById('drawer').classList.remove('active');
      document.getElementById('drawerOverlay').classList.remove('active');
    }
    
    function setTheme(theme) {
      currentTheme = theme;
      document.body.className = `theme-${theme}`;
      localStorage.setItem(STORAGE_KEYS.THEME, theme);
      
      // Update active state of theme buttons
      document.querySelectorAll('.theme-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.theme === theme) {
          btn.classList.add('active');
        }
      });
      
      setTimeout(() => {
        updateAllGraphs();
        if (selectedSubjectForGraph) {
          updateSubjectDonutChart(selectedSubjectForGraph);
        }
      }, 100);
    }
    
    function setLanguage(lang) {
      currentLanguage = lang;
      localStorage.setItem(STORAGE_KEYS.LANGUAGE, lang);
      
      // Update active state of language buttons
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.lang === lang) {
          btn.classList.add('active');
        }
      });
      
      updateAllTexts();
    }
    
    function updateAllTexts() {
      document.title = t('appName');
      document.getElementById('studentName').placeholder = t('namePlaceholder');
      
      const startBtn = document.getElementById('startTracking');
      if (startBtn) {
        const studentName = localStorage.getItem(STORAGE_KEYS.STUDENT_NAME) || "";
        startBtn.innerHTML = `<i class="fas fa-rocket"></i> ${studentName ? t('continue') : t('getStarted')}`;
      }
      
      updateGreeting();
      
      document.querySelectorAll('.card h2').forEach(card => {
        if (card.innerHTML.includes('Subjects and Topics') || card.innerHTML.includes('विषय और टॉपिक्स')) {
          const progressSpan = document.getElementById('totalProgress');
          card.innerHTML = `<i class="fas fa-graduation-cap"></i> ${t('subjects')} <span id="totalProgress">${progressSpan ? progressSpan.textContent : '(0% Complete)'}</span>
            <div class="subject-controls">
              <button id="expandAll">
                <i class="fas fa-expand-alt"></i> ${t('expandAll')}
              </button>
              <button id="collapseAll">
                <i class="fas fa-compress-alt"></i> ${t('collapseAll')}
              </button>
            </div>`;
        } else if (card.innerHTML.includes('Progress Overview') || card.innerHTML.includes('प्रगति अवलोकन')) {
          card.innerHTML = `<i class="fas fa-chart-pie"></i> ${t('progressOverview')}`;
        } else if (card.innerHTML.includes('Mock Test Analysis') || card.innerHTML.includes('मॉक विश्लेषण')) {
          card.innerHTML = `<i class="fas fa-chart-line"></i> ${t('mockAnalysis')}`;
        }
      });
      
      // Update CBT buttons text
      const tier1Btn = document.querySelector('.cbt-type-btn[data-cbt="tier1"]');
      const tier2Btn = document.querySelector('.cbt-type-btn[data-cbt="tier2"]');
      if (tier1Btn) tier1Btn.innerHTML = `<i class="fas fa-file-alt"></i> ${t('tier1')}`;
      if (tier2Btn) tier2Btn.innerHTML = `<i class="fas fa-file-alt"></i> ${t('tier2')}`;
      
      const formLabels = {
        'testName': t('testName'),
        'testDate': t('date'),
        'quantitativeMarks': t('quantitativeMarks'),
        'englishMarks': t('englishMarks'),
        'reasoningMarks': t('reasoningMarks'),
        'awarenessMarks': t('awarenessMarks'),
        'accuracy': t('accuracy'),
        'totalMarks': t('totalMarks')
      };
      
      Object.keys(formLabels).forEach(id => {
        const label = document.querySelector(`label[for="${id}"]`);
        if (label) {
          label.textContent = formLabels[id];
        }
      });
      
      const saveButton = document.querySelector('#cbtForm button[type="submit"]');
      if (saveButton) {
        saveButton.innerHTML = `<i class="fas fa-save"></i> ${t('save')}`;
      }
      
      const historyButton = document.getElementById('showHistoryBtn');
      if (historyButton) {
        historyButton.innerHTML = `<i class="fas fa-history"></i> ${t('viewHistory')}`;
      }
      
      const historyTitle = document.querySelector('#historyModal h2');
      if (historyTitle) {
        historyTitle.innerHTML = `<i class="fas fa-history"></i> ${t('testHistory')}`;
      }
      
      const expandBtn = document.getElementById('expandAll');
      const collapseBtn = document.getElementById('collapseAll');
      if (expandBtn) expandBtn.innerHTML = `<i class="fas fa-expand-alt"></i> ${t('expandAll')}`;
      if (collapseBtn) collapseBtn.innerHTML = `<i class="fas fa-compress-alt"></i> ${t('collapseAll')}`;
      
      renderSubjects();
      updateProgress();
      loadCBTResults();
      initializeSubjectSelector();
      updateAllGraphs();
      updateAverageScores();
      
      if (selectedSubjectForGraph) {
        updateSubjectDonutChart(selectedSubjectForGraph);
      }
    }
    
    function initializeSubjectSelector() {
      const selector = document.getElementById('subjectSelector');
      if (!selector) return;
      
      selector.innerHTML = '';
      
      CONFIG.subjects.forEach(subject => {
        const button = document.createElement('button');
        button.className = 'subject-selector-btn';
        button.dataset.subject = subject.id;
        button.innerHTML = `
          <i class="fas fa-chart-pie"></i>
          ${subject.title[currentLanguage].split('(')[0].trim()}
        `;
        
        if (subject.id === selectedSubjectForGraph) {
          button.classList.add('active');
        }
        
        button.addEventListener('click', function() {
          selectedSubjectForGraph = this.dataset.subject;
          
          document.querySelectorAll('.subject-selector-btn').forEach(btn => {
            btn.classList.remove('active');
          });
          this.classList.add('active');
          
          updateSubjectDonutChart(selectedSubjectForGraph);
        });
        
        selector.appendChild(button);
      });
    }
    
    // ========== STORAGE FUNCTIONS ==========
    function saveProgress() {
      localStorage.setItem(STORAGE_KEYS.PROGRESS, JSON.stringify(savedProgress));
    }
    
    function saveUIState() {
      localStorage.setItem(STORAGE_KEYS.UI_STATE, JSON.stringify(savedUIState));
    }
    
    function saveAllData() {
      saveProgress();
      saveUIState();
      localStorage.setItem(STORAGE_KEYS.CBT_RESULTS, JSON.stringify(cbtResults));
      localStorage.setItem(STORAGE_KEYS.STUDY_LOG, JSON.stringify(studyLog));
    }
    
    // ========== BACKUP FUNCTIONS ==========
    function exportBackup() {
      const backupData = {
        app: CONFIG.appName,
        version: CONFIG.appVersion,
        timestamp: new Date().toISOString(),
        studentName: localStorage.getItem(STORAGE_KEYS.STUDENT_NAME),
        progress: savedProgress,
        uiState: savedUIState,
        cbtResults: cbtResults,
        studyLog: studyLog,
        theme: currentTheme,
        language: currentLanguage
      };
      
      const dataStr = JSON.stringify(backupData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = `ssc_cgl_backup_${new Date().toISOString().slice(0,10)}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      alert('Backup exported successfully!');
    }
    
    function importBackup(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const backupData = JSON.parse(e.target.result);
          
          if (!backupData.app || !backupData.version) {
            throw new Error('Invalid backup file');
          }
          
          if (backupData.studentName) {
            localStorage.setItem(STORAGE_KEYS.STUDENT_NAME, backupData.studentName);
          }
          
          if (backupData.progress) {
            savedProgress = backupData.progress;
            localStorage.setItem(STORAGE_KEYS.PROGRESS, JSON.stringify(savedProgress));
          }
          
          if (backupData.uiState) {
            savedUIState = backupData.uiState;
            localStorage.setItem(STORAGE_KEYS.UI_STATE, JSON.stringify(savedUIState));
          }
          
          if (backupData.cbtResults) {
            cbtResults = backupData.cbtResults;
            localStorage.setItem(STORAGE_KEYS.CBT_RESULTS, JSON.stringify(cbtResults));
          }
          
          if (backupData.studyLog) {
            studyLog = backupData.studyLog;
            localStorage.setItem(STORAGE_KEYS.STUDY_LOG, JSON.stringify(studyLog));
          }
          
          if (backupData.theme) {
            currentTheme = backupData.theme;
            localStorage.setItem(STORAGE_KEYS.THEME, currentTheme);
            setTheme(currentTheme);
          }
          
          if (backupData.language) {
            currentLanguage = backupData.language;
            localStorage.setItem(STORAGE_KEYS.LANGUAGE, currentLanguage);
            setLanguage(currentLanguage);
          }
          
          updateGreeting();
          renderSubjects();
          updateProgress();
          loadCBTResults();
          initializeSubjectSelector();
          updateAllGraphs();
          updateAverageScores();
          
          alert('Backup imported successfully!');
        } catch (error) {
          alert('Invalid backup file. Please choose a valid backup file.');
          console.error('Import error:', error);
        }
      };
      
      reader.readAsText(file);
      event.target.value = '';
    }
    
    // ========== SHARE WEBSITE FUNCTION ==========
    async function shareWebsite() {
      try {
        const shareText = currentLanguage === 'hi' ? 
          '🚀 एसएससी सीजीएल परीक्षा की तैयारी के लिए SSC CGL PRO ऐप का उपयोग करें!\n\n📊 अपनी प्रगति ट्रैक करें और अपने प्रदर्शन में सुधार करें।\n\n🔗 लिंक: https://skpro7.github.io/cgl/\n\n#SSC_CGL_PRO #SSC_CGL #ExamPreparation 💪' :
          '🚀 Use SSC CGL PRO app for SSC CGL exam preparation!\n\n📊 Track your progress and improve your performance.\n\n🔗 Link: https://skpro7.github.io/cgl/\n\n#SSC_CGL_PRO #SSC_CGL #ExamPreparation 💪';
        
        if (navigator.share) {
          await navigator.share({
            title: 'SSC CGL PRO - SSC CGL Preparation',
            text: shareText
          });
        } else {
          await navigator.clipboard.writeText(shareText);
          alert(currentLanguage === 'hi' ? 
            'वेबसाइट लिंक क्लिपबोर्ड पर कॉपी किया गया! आप अब इसे साझा कर सकते हैं।' : 
            'Website link copied to clipboard! You can now share it.');
        }
      } catch (error) {
        console.error('Error sharing website:', error);
      }
    }
    
    // ========== INITIALIZE APP ==========
    document.addEventListener('DOMContentLoaded', initializeApp);
  </script>
</body>
</html>


